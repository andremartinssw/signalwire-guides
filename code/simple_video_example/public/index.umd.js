!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e||self).VideoSDK={})}(this,function(e){function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,a(e,t)}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function c(e,t,n){return(c=u()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&a(o,n.prototype),o}).apply(null,arguments)}function s(e){var t="function"==typeof Map?new Map:void 0;return(s=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return c(e,arguments,i(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),a(n,e)})(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}!function(e){var t=function(e){var t,n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var o=Object.create((t&&t.prototype instanceof y?t:y).prototype),i=new I(r||[]);return o._invoke=function(e,t,n){var r=l;return function(o,i){if(r===p)throw new Error("Generator is already running");if(r===h){if("throw"===o)throw i;return C()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var u=P(a,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===l)throw r=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var c=f(e,t,n);if("normal"===c.type){if(r=n.done?h:d,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=h,n.method="throw",n.arg=c.arg)}}}(e,n,i),o}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var l="suspendedStart",d="suspendedYield",p="executing",h="completed",v={};function y(){}function m(){}function g(){}var b={};b[i]=function(){return this};var w=Object.getPrototypeOf,S=w&&w(w(A([])));S&&S!==n&&r.call(S,i)&&(b=S);var k=g.prototype=y.prototype=Object.create(b);function E(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function O(e,t){function n(o,i,a,u){var c=f(e[o],e,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==typeof l&&r.call(l,"__await")?t.resolve(l.__await).then(function(e){n("next",e,a,u)},function(e){n("throw",e,a,u)}):t.resolve(l).then(function(e){s.value=e,a(s)},function(e){return n("throw",e,a,u)})}u(c.arg)}var o;this._invoke=function(e,r){function i(){return new t(function(t,o){n(e,r,t,o)})}return o=o?o.then(i,i):i()}}function P(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,P(e,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=f(r,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function A(e){if(e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:C}}function C(){return{value:t,done:!0}}return m.prototype=k.constructor=g,g.constructor=m,m.displayName=c(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,c(e,u,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},E(O.prototype),O.prototype[a]=function(){return this},e.AsyncIterator=O,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new O(s(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then(function(e){return e.done?e.value:a.next()})},E(k),c(k,u,"Generator"),k[i]=function(){return this},k.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=A,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return u.type="throw",u.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),x(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;x(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}({});try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}();var p,h,v,y,m,g,b=regeneratorRuntime.mark(fr),w=regeneratorRuntime.mark(lr),S=regeneratorRuntime.mark(pr),k=regeneratorRuntime.mark(hr),E=regeneratorRuntime.mark(vr),O=regeneratorRuntime.mark(yr);function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED"}(p||(p={})),function(e){e.Broadcast="blade.broadcast",e.Disconnect="blade.disconnect",e.Connect="blade.connect",e.Ping="blade.ping",e.Reauthenticate="blade.reauthenticate",e.Execute="blade.execute"}(h||(h={})),function(e){e.Invite="verto.invite",e.Attach="verto.attach",e.Answer="verto.answer",e.Info="verto.info",e.Display="verto.display",e.Media="verto.media",e.Event="verto.event",e.Bye="verto.bye",e.Punt="verto.punt",e.Broadcast="verto.broadcast",e.Subscribe="verto.subscribe",e.Unsubscribe="verto.unsubscribe",e.ClientReady="verto.clientReady",e.Modify="verto.modify",e.MediaParams="verto.mediaParams",e.Prompt="verto.prompt",e.JsApi="jsapi",e.Stats="verto.stats",e.Ping="verto.ping",e.Announce="verto.announce"}(v||(v={})),function(e){e.New="new",e.Requesting="requesting",e.Trying="trying",e.Recovering="recovering",e.Ringing="ringing",e.Answering="answering",e.Early="early",e.Active="active",e.Held="held",e.Hangup="hangup",e.Destroy="destroy",e.Purge="purge"}(y||(y={})),function(e){e.MemberAudioMute="conference.member.audio_mute",e.MemberAudioUnmute="conference.member.audio_unmute",e.MemberVideoMute="conference.member.video_mute",e.MemberVideoUnmute="conference.member.video_unmute"}(m||(m={}));var _=new Uint8Array(16);function x(){if(!g&&!(g="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return g(_)}var I=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function A(e){return"string"==typeof e&&I.test(e)}for(var C=[],T=0;T<256;++T)C.push((T+256).toString(16).substr(1));function j(e,t,n){var r=(e=e||{}).random||(e.rng||x)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(C[e[t+0]]+C[e[t+1]]+C[e[t+2]]+C[e[t+3]]+"-"+C[e[t+4]]+C[e[t+5]]+"-"+C[e[t+6]]+C[e[t+7]]+"-"+C[e[t+8]]+C[e[t+9]]+"-"+C[e[t+10]]+C[e[t+11]]+C[e[t+12]]+C[e[t+13]]+C[e[t+14]]+C[e[t+15]]).toLowerCase();if(!A(n))throw TypeError("Stringified UUID is invalid");return n}(r)}var R="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},N=function(e){var t={exports:{}};return function(e){var t,n;t=R,n=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function o(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function i(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?i:void 0!==console[r]?o(console,r):void 0!==console.log?o(console,"log"):e)}function u(t,n){for(var o=0;o<r.length;o++){var i=r[o];this[i]=o<t?e:this.methodFactory(i,t,n)}this.log=this.debug}function c(e,n,r){return function(){typeof console!==t&&(u.call(this,n,r),this[e].apply(this,arguments))}}function s(e,t,n){return a(e)||c.apply(this,arguments)}function f(e,n,o){var i,a=this,c="loglevel";function f(){var e;if(typeof window!==t&&c){try{e=window.localStorage[c]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(c)+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(e){}return void 0===a.levels[e]&&(e=void 0),e}}"string"==typeof e?c+=":"+e:"symbol"==typeof e&&(c=void 0),a.name=e,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=o||s,a.getLevel=function(){return i},a.setLevel=function(n,o){if("string"==typeof n&&void 0!==a.levels[n.toUpperCase()]&&(n=a.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(i=n,!1!==o&&function(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&c){try{return void(window.localStorage[c]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(e){}}}(n),u.call(a,n,e),typeof console===t&&n<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(e){f()||a.setLevel(e,!1)},a.enableAll=function(e){a.setLevel(a.levels.TRACE,e)},a.disableAll=function(e){a.setLevel(a.levels.SILENT,e)};var l=f();null==l&&(l=null==n?"WARN":n),a.setLevel(l,!1)}var l=new f,d={};l.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new f(e,l.getLevel(),l.methodFactory)),t};var p=typeof window!==t?window.log:void 0;return l.noConflict=function(){return typeof window!==t&&window.log===l&&(window.log=p),l},l.getLoggers=function(){return d},l.default=l,l},e.exports?e.exports=n():t.log=n()}(t),t.exports}(),L=function(){return(new Date).toISOString().replace("T"," ").replace("Z","")},D=N.getLogger("signalwire"),M=D.methodFactory;D.methodFactory=function(e,t,n){var r=M(e,t,n);return function(){for(var e=[L(),"-"],t=0;t<arguments.length;t++)e.push(arguments[t]);r.apply(void 0,e)}},D.setLevel(D.getLevel());var F=function e(t,n){var r=t.result,o=void 0===r?{}:r,i=t.error;if(i)return{error:i};var a=o.result,u=void 0===a?null:a;if(null===u)return n&&(o.node_id=n),{result:o};var c=u.code,s=void 0===c?null:c,f=u.node_id,l=u.result,d=void 0===l?null:l;return s&&"200"!==s?{error:u}:d?e(d,void 0===f?null:f):{result:u}},U=function(e){if("string"!=typeof e)return e;try{return JSON.parse(e)}catch(t){return e}},V=/^(ws|wss):\/\//,q=function(e){var t;return P({jsonrpc:"2.0",id:null!=(t=e.id)?t:j()},e)},B=function(e){return P({jsonrpc:"2.0"},e)},K={major:2,minor:5,revision:0},H=function(e){return q({method:h.Connect,params:P({version:K,agent:null},e)})},W=function(e){return q({method:h.Execute,params:e})},z=function(e,t){return B({id:e,result:{method:t}})};function G(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map(function(e){return"'"+e+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function J(e){return!!e&&!!e[Re]}function X(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return"function"==typeof n&&Function.toString.call(n)===Ne}(e)||Array.isArray(e)||!!e[je]||!!e.constructor[je]||te(e)||ne(e))}function Y(e,t,n){void 0===n&&(n=!1),0===$(e)?(n?Object.keys:Le)(e).forEach(function(r){n&&"symbol"==typeof r||t(r,e[r],e)}):e.forEach(function(n,r){return t(r,n,e)})}function $(e){var t=e[Re];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:te(e)?2:ne(e)?3:0}function Q(e,t){return 2===$(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Z(e,t,n){var r=$(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function ee(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function te(e){return Ie&&e instanceof Map}function ne(e){return Ae&&e instanceof Set}function re(e){return e.o||e.t}function oe(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=De(e);delete t[Re];for(var n=Le(t),r=0;r<n.length;r++){var o=n[r],i=t[o];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(t[o]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[o]})}return Object.create(Object.getPrototypeOf(e),t)}function ie(e,t){return void 0===t&&(t=!1),ue(e)||J(e)||!X(e)||($(e)>1&&(e.set=e.add=e.clear=e.delete=ae),Object.freeze(e),t&&Y(e,function(e,t){return ie(t,!0)},!0)),e}function ae(){G(2)}function ue(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function ce(e){var t=Me[e];return t||G(18,e),t}function se(){return _e}function fe(e,t){t&&(ce("Patches"),e.u=[],e.s=[],e.v=t)}function le(e){de(e),e.p.forEach(he),e.p=null}function de(e){e===_e&&(_e=e.l)}function pe(e){return _e={p:[],l:_e,h:e,m:!0,_:0}}function he(e){var t=e[Re];0===t.i||1===t.i?t.j():t.g=!0}function ve(e,t){t._=t.p.length;var n=t.p[0],r=void 0!==e&&e!==n;return t.h.O||ce("ES5").S(t,e,r),r?(n[Re].P&&(le(t),G(4)),X(e)&&(e=ye(t,e),t.l||ge(t,e)),t.u&&ce("Patches").M(n[Re],e,t.u,t.s)):e=ye(t,n,[]),le(t),t.u&&t.v(t.u,t.s),e!==Te?e:void 0}function ye(e,t,n){if(ue(t))return t;var r=t[Re];if(!r)return Y(t,function(o,i){return me(e,r,t,o,i,n)},!0),t;if(r.A!==e)return t;if(!r.P)return ge(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var o=4===r.i||5===r.i?r.o=oe(r.k):r.o;Y(3===r.i?new Set(o):o,function(t,i){return me(e,r,o,t,i,n)}),ge(e,o,!1),n&&e.u&&ce("Patches").R(r,n,e.u,e.s)}return r.o}function me(e,t,n,r,o,i){if(J(o)){var a=ye(e,o,i&&t&&3!==t.i&&!Q(t.D,r)?i.concat(r):void 0);if(Z(n,r,a),!J(a))return;e.m=!1}if(X(o)&&!ue(o)){if(!e.h.F&&e._<1)return;ye(e,o),t&&t.A.l||ge(e,o)}}function ge(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&ie(t,n)}function be(e,t){var n=e[Re];return(n?re(n):e)[t]}function we(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function Se(e){e.P||(e.P=!0,e.l&&Se(e.l))}function ke(e){e.o||(e.o=oe(e.t))}function Ee(e,t,n){var r=te(t)?ce("MapSet").N(t,n):ne(t)?ce("MapSet").T(t,n):e.O?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:se(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},o=r,i=Fe;n&&(o=[r],i=Ue);var a=Proxy.revocable(o,i),u=a.revoke,c=a.proxy;return r.k=c,r.j=u,c}(t,n):ce("ES5").J(t,n);return(n?n.A:se()).p.push(r),r}function Oe(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return oe(e)}var Pe,_e,xe="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),Ie="undefined"!=typeof Map,Ae="undefined"!=typeof Set,Ce="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,Te=xe?Symbol.for("immer-nothing"):((Pe={})["immer-nothing"]=!0,Pe),je=xe?Symbol.for("immer-draftable"):"__$immer_draftable",Re=xe?Symbol.for("immer-state"):"__$immer_state",Ne=""+Object.prototype.constructor,Le="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,De=Object.getOwnPropertyDescriptors||function(e){var t={};return Le(e).forEach(function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)}),t},Me={},Fe={get:function(e,t){if(t===Re)return e;var n=re(e);if(!Q(n,t))return function(e,t,n){var r,o=we(t,n);return o?"value"in o?o.value:null===(r=o.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!X(r)?r:r===be(e.t,t)?(ke(e),e.o[t]=Ee(e.A.h,r,e)):r},has:function(e,t){return t in re(e)},ownKeys:function(e){return Reflect.ownKeys(re(e))},set:function(e,t,n){var r=we(re(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var o=be(re(e),t),i=null==o?void 0:o[Re];if(i&&i.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(ee(n,o)&&(void 0!==n||Q(e.t,t)))return!0;ke(e),Se(e)}return e.o[t]===n&&"number"!=typeof n||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==be(e.t,t)||t in e.t?(e.D[t]=!1,ke(e),Se(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=re(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){G(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){G(12)}},Ue={};Y(Fe,function(e,t){Ue[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),Ue.deleteProperty=function(e,t){return Fe.deleteProperty.call(this,e[0],t)},Ue.set=function(e,t,n){return Fe.set.call(this,e[0],t,n,e[0])};var Ve=new(function(){function e(e){var t=this;this.O=Ce,this.F=!0,this.produce=function(e,n,r){if("function"==typeof e&&"function"!=typeof n){var o=n;n=e;var i=t;return function(e){var t=this;void 0===e&&(e=o);for(var r=arguments.length,a=Array(r>1?r-1:0),u=1;u<r;u++)a[u-1]=arguments[u];return i.produce(e,function(e){var r;return(r=n).call.apply(r,[t,e].concat(a))})}}var a;if("function"!=typeof n&&G(6),void 0!==r&&"function"!=typeof r&&G(7),X(e)){var u=pe(t),c=Ee(t,e,void 0),s=!0;try{a=n(c),s=!1}finally{s?le(u):de(u)}return"undefined"!=typeof Promise&&a instanceof Promise?a.then(function(e){return fe(u,r),ve(e,u)},function(e){throw le(u),e}):(fe(u,r),ve(a,u))}if(!e||"object"!=typeof e){if((a=n(e))===Te)return;return void 0===a&&(a=e),t.F&&ie(a,!0),a}G(21,e)},this.produceWithPatches=function(e,n){return"function"==typeof e?function(n){for(var r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return t.produceWithPatches(n,function(t){return e.apply(void 0,[t].concat(o))})}:[t.produce(e,n,function(e,t){r=e,o=t}),r,o];var r,o},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){X(e)||G(8),J(e)&&(e=function(e){return J(e)||G(22,e),function e(t){if(!X(t))return t;var n,r=t[Re],o=$(t);if(r){if(!r.P&&(r.i<4||!ce("ES5").K(r)))return r.t;r.I=!0,n=Oe(t,o),r.I=!1}else n=Oe(t,o);return Y(n,function(t,o){r&&function(e,t){return 2===$(e)?e.get(t):e[t]}(r.t,t)===o||Z(n,t,e(o))}),3===o?new Set(n):n}(e)}(e));var t=pe(this),n=Ee(this,e,void 0);return n[Re].C=!0,de(t),n},t.finishDraft=function(e,t){var n=(e&&e[Re]).A;return fe(n,t),ve(void 0,n)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!Ce&&G(20),this.O=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}var o=ce("Patches").$;return J(e)?o(e,t):this.produce(e,function(e){return o(e,t.slice(n+1))})},e}()),qe=Ve.produce;Ve.produceWithPatches.bind(Ve),Ve.setAutoFreeze.bind(Ve),Ve.setUseProxies.bind(Ve),Ve.applyPatches.bind(Ve),Ve.createDraft.bind(Ve),Ve.finishDraft.bind(Ve);var Be=function(e){var t,n=("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()).Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}(),Ke=function(){return Math.random().toString(36).substring(7).split("").join(".")},He={INIT:"@@redux/INIT"+Ke(),REPLACE:"@@redux/REPLACE"+Ke(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Ke()}};function We(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function ze(e,t,n){var r;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(ze)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var o=e,i=t,a=[],u=a,c=!1;function s(){u===a&&(u=a.slice())}function f(){if(c)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return i}function l(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(c)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return s(),u.push(e),function(){if(t){if(c)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,s();var n=u.indexOf(e);u.splice(n,1),a=null}}}function d(e){if(!We(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(c)throw new Error("Reducers may not dispatch actions.");try{c=!0,i=o(i,e)}finally{c=!1}for(var t=a=u,n=0;n<t.length;n++)(0,t[n])();return e}function p(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");o=e,d({type:He.REPLACE})}function h(){var e,t=l;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(f())}return n(),{unsubscribe:t(n)}}})[Be]=function(){return this},e}return d({type:He.INIT}),(r={dispatch:d,subscribe:l,getState:f,replaceReducer:p})[Be]=h,r}function Ge(e,t){var n=t&&t.type;return"Given "+(n&&'action "'+String(n)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function Je(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var o=t[r];"function"==typeof e[o]&&(n[o]=e[o])}var i,a=Object.keys(n);try{!function(e){Object.keys(e).forEach(function(t){var n=e[t];if(void 0===n(void 0,{type:He.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===n(void 0,{type:He.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+He.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}(n)}catch(e){i=e}return function(e,t){if(void 0===e&&(e={}),i)throw i;for(var r=!1,o={},u=0;u<a.length;u++){var c=a[u],s=e[c],f=(0,n[c])(s,t);if(void 0===f){var l=Ge(c,t);throw new Error(l)}o[c]=f,r=r||f!==s}return(r=r||a.length!==Object.keys(e).length)?o:e}}function Xe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ye(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(n,!0).forEach(function(t){Xe(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Qe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function Ze(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},o={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},i=t.map(function(e){return e(o)});return $e({},n,{dispatch:r=Qe.apply(void 0,i)(n.dispatch)})}}}function et(e,t){return e===t}function tt(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var r=t.length,o=0;o<r;o++)if(!e(t[o],n[o]))return!1;return!0}function nt(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(o){return"function"==typeof o?o(n,r,e):t(o)}}}}!function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r]}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:et,n=null,r=null;return function(){return tt(t,n,arguments)||(r=e.apply(null,arguments)),n=arguments,r}});var rt=nt();function ot(){return(ot=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function it(e){return(it=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function at(e,t){return(at=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ut(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function ct(e,t,n){return(ct=ut()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&at(o,n.prototype),o}).apply(null,arguments)}function st(e){var t="function"==typeof Map?new Map:void 0;return(st=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return ct(e,arguments,it(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),at(n,e)})(e)}rt.withExtraArgument=nt;var ft="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?Qe:Qe.apply(null,arguments)},lt=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o=r.prototype;return o.concat=function(){for(var t,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return ct(r,(t=e.prototype.concat).call.apply(t,[this].concat(o)))},o.prepend=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 1===t.length&&Array.isArray(t[0])?ct(r,t[0].concat(this)):ct(r,t.concat(this))},r}(st(Array));function dt(e){var t,n=function(e){return function(e){void 0===e&&(e={});var t=e.thunk,n=void 0===t||t,r=new lt;return n&&(function(e){return"boolean"==typeof e}(n)?r.push(rt):r.push(rt.withExtraArgument(n.extraArgument))),r}(e)},r=e||{},o=r.reducer,i=void 0===o?void 0:o,a=r.middleware,u=void 0===a?n():a,c=r.devTools,s=void 0===c||c,f=r.preloadedState,l=void 0===f?void 0:f,d=r.enhancers,p=void 0===d?void 0:d;if("function"==typeof i)t=i;else{if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(i))throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');t=Je(i)}var h=Ze.apply(void 0,"function"==typeof u?u(n):u),v=Qe;s&&(v=ft(ot({trace:!1},"object"==typeof s&&s)));var y=[h];return Array.isArray(p)?y=[h].concat(p):"function"==typeof p&&(y=p(y)),ze(t,l,v.apply(void 0,y))}function pt(e,t){function n(){if(t){var n=t.apply(void 0,arguments);if(!n)throw new Error("prepareAction did not return an object");return ot({type:e,payload:n.payload},"meta"in n&&{meta:n.meta},{},"error"in n&&{error:n.error})}return{type:e,payload:arguments.length<=0?void 0:arguments[0]}}return n.toString=function(){return""+e},n.type=e,n.match=function(t){return t.type===e},n}function ht(e){var t,n={},r=[],o={addCase:function(e,t){var r="string"==typeof e?e:e.type;if(r in n)throw new Error("addCase cannot be called with two reducers for the same action type");return n[r]=t,o},addMatcher:function(e,t){return r.push({matcher:e,reducer:t}),o},addDefaultCase:function(e){return t=e,o}};return e(o),[n,r,t]}function vt(e){var t=e.name,n=e.initialState;if(!t)throw new Error("`name` is a required option for createSlice");var r=e.reducers||{},o=void 0===e.extraReducers?[]:"function"==typeof e.extraReducers?ht(e.extraReducers):[e.extraReducers],i=o[0],a=void 0===i?{}:i,u=o[1],c=void 0===u?[]:u,s=o[2],f=void 0===s?void 0:s,l=Object.keys(r),d={},p={},h={};l.forEach(function(e){var n,o,i=r[e],a=t+"/"+e;"reducer"in i?(n=i.reducer,o=i.prepare):n=i,d[e]=n,p[a]=n,h[e]=o?pt(a,o):pt(a)});var v=function(e,t,n,r){void 0===n&&(n=[]);var o="function"==typeof t?ht(t):[t,n,r],i=o[0],a=o[1],u=o[2],c=qe(e,function(){});return function(e,t){void 0===e&&(e=c);var n=[i[t.type]].concat(a.filter(function(e){return(0,e.matcher)(t)}).map(function(e){return e.reducer}));return 0===n.filter(function(e){return!!e}).length&&(n=[u]),n.reduce(function(e,n){if(n){if(J(e)){var r=n(e,t);return void 0===r?e:r}if(X(e))return qe(e,function(e){return n(e,t)});var o=n(e,t);if(void 0===o){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return o}return e},e)}}(n,ot({},a,{},p),c,f);return{name:t,reducer:v,actions:h,caseReducers:d}}"undefined"==typeof Symbol||Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")),"undefined"==typeof Symbol||Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")),function(){function e(e,t){var n=o[e];return n?n.enumerable=t:o[e]=n={configurable:!0,enumerable:t,get:function(){return Fe.get(this[Re],e)},set:function(t){Fe.set(this[Re],e,t)}},n}function t(e){for(var t=e.length-1;t>=0;t--){var o=e[t][Re];if(!o.P)switch(o.i){case 5:r(o)&&Se(o);break;case 4:n(o)&&Se(o)}}}function n(e){for(var t=e.t,n=e.k,r=Le(n),o=r.length-1;o>=0;o--){var i=r[o];if(i!==Re){var a=t[i];if(void 0===a&&!Q(t,i))return!0;var u=n[i],c=u&&u[Re];if(c?c.t!==a:!ee(u,a))return!0}}var s=!!t[Re];return r.length!==Le(t).length+(s?0:1)}function r(e){var t=e.k;if(t.length!==e.t.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!n||n.get)}var o={};!function(e,t){Me.ES5||(Me.ES5=t)}(0,{J:function(t,n){var r=Array.isArray(t),o=function(t,n){if(t){for(var r=Array(n.length),o=0;o<n.length;o++)Object.defineProperty(r,""+o,e(o,!0));return r}var i=De(n);delete i[Re];for(var a=Le(i),u=0;u<a.length;u++){var c=a[u];i[c]=e(c,t||!!i[c].enumerable)}return Object.create(Object.getPrototypeOf(n),i)}(r,t),i={i:r?5:4,A:n?n.A:se(),P:!1,I:!1,D:{},l:n,t:t,k:o,o:null,g:!1,C:!1};return Object.defineProperty(o,Re,{value:i,writable:!0}),o},S:function(e,n,o){o?J(n)&&n[Re].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var n=t[Re];if(n){var o=n.t,i=n.k,a=n.D,u=n.i;if(4===u)Y(i,function(t){t!==Re&&(void 0!==o[t]||Q(o,t)?a[t]||e(i[t]):(a[t]=!0,Se(n)))}),Y(o,function(e){void 0!==i[e]||Q(i,e)||(a[e]=!1,Se(n))});else if(5===u){if(r(n)&&(Se(n),a.length=!0),i.length<o.length)for(var c=i.length;c<o.length;c++)a[c]=!1;else for(var s=o.length;s<i.length;s++)a[s]=!0;for(var f=Math.min(i.length,o.length),l=0;l<f;l++)void 0===a[l]&&e(i[l])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?n(e):r(e)}})}();var yt=pt("swSdk/init"),mt=pt("swSdk/destroy"),gt=pt("swSdk/executeRequest"),bt=pt("auth/error"),wt=pt("auth/success"),St=pt("socket/closed"),kt=pt("socket/error"),Et=pt("socket/message"),Ot=function(e){function t(t){var n;return(n=e.call(this,t)||this).options=t,n.WebSocketConstructor=WebSocket,n._expiredDiffSeconds=0,n._refreshTokenNotificationDiff=120,n._checkTokenExpirationDelay=2e4,n._checkTokenExpirationTimer=null,n._checkTokenExpiration=n._checkTokenExpiration.bind(f(n)),n}o(t,e);var r=t.prototype;return r.authenticate=function(){try{var e=this,t=function(){return Promise.resolve(e.execute(H(n))).then(function(t){e._bladeConnectResult=t,e._checkTokenExpiration()})},n={authentication:{jwt_token:e.options.token},params:{}},r=function(){if(e._relayProtocolIsValid())n.params=n.params||{},n.params.protocol=e.relayProtocol;else{var t=function(){if(e.signature)return Promise.resolve((t=e.signature,function(e,t){try{if("undefined"==typeof window&&"undefined"!=typeof process)return Promise.resolve(null);var n=window.sessionStorage.getItem(function(e){return"@signalwire:"+e}(t));return Promise.resolve(U(n))}catch(e){return Promise.reject(e)}}(0,t))).then(function(e){e&&(n.params=n.params||{},n.params.protocol=e)});var t}();if(t&&t.then)return t.then(function(){})}}();return Promise.resolve(r&&r.then?r.then(t):t())}catch(e){return Promise.reject(e)}},r._checkTokenExpiration=function(){this.expiresAt&&(this.expiresIn<=this._refreshTokenNotificationDiff&&D.debug("Your JWT is going to expire. Please refresh it to keep the session live."),clearTimeout(this._checkTokenExpirationTimer),this.expired||(this._checkTokenExpirationTimer=setTimeout(this._checkTokenExpiration,this._checkTokenExpirationDelay)))},n(t,[{key:"expiresAt",get:function(){var e,t,n;return null!=(e=null==this||null==(t=this._bladeConnectResult)||null==(n=t.authorization)?void 0:n.expires_at)?e:0}},{key:"expiresIn",get:function(){var e=Math.floor(Date.now()/1e3);return this.expiresAt-e}},{key:"expired",get:function(){return this.expiresIn<=this._expiredDiffSeconds}}]),t}(function(){function e(e){var t;this.options=e,this.uuid=j(),this.sessionid="",this._requests=new Map,this._requestQueue=[],this._idle=!0,this._host="wss://relay.signalwire.com",this._executeTimeoutMs=1e4,this._executeTimeoutError=Symbol.for("sw-execute-timeout"),this._checkPingDelay=15e3,this._checkPingTimer=null,e.host&&(this._host=(V.test(t=e.host)?"":"wss://")+t),this._onSocketOpen=this._onSocketOpen.bind(this),this._onSocketError=this._onSocketError.bind(this),this._onSocketClose=this._onSocketClose.bind(this),this._onSocketMessage=this._onSocketMessage.bind(this),this.execute=this.execute.bind(this),this.logger.setLevel(this.logger.levels.INFO)}var t=e.prototype;return t.connect=function(){null!=this&&this.WebSocketConstructor?this._socket?D.warn("Session already connected."):(this._socket=new this.WebSocketConstructor(this._host),this._socket.onopen=this._onSocketOpen,this._socket.onclose=this._onSocketClose,this._socket.onerror=this._onSocketError,this._socket.onmessage=this._onSocketMessage):D.error("Missing WebSocketConstructor")},t.disconnect=function(){try{var e=this;return!e._socket||e.closing?(D.warn("Session not connected or already in closing state."),Promise.resolve()):(e._socket.close(),delete e._socket,Promise.resolve())}catch(e){return Promise.reject(e)}},t.execute=function(e){var t,n=this;return this._idle?new Promise(function(t){return n._requestQueue.push({resolve:t,msg:e})}):this.connected?(t="params"in e?new Promise(function(t,r){n._requests.set(e.id,{rpcRequest:e,resolve:t,reject:r})}):Promise.resolve(),D.debug("SEND: \n",JSON.stringify(e,null,2),"\n"),this._socket.send(JSON.stringify(e)),function(e,t,n){var r=null;return Promise.race([e,new Promise(function(e,o){return r=setTimeout(o,t,n)})]).finally(function(){return clearTimeout(r)})}(t,this._executeTimeoutMs,this._executeTimeoutError).catch(function(t){if(t!==n._executeTimeoutError)throw t;D.error("Request Timeout",e)})):new Promise(function(t){n._requestQueue.push({resolve:t,msg:e}),n.connect()})},t.authenticate=function(){try{var e=this,t={authentication:{project:e.options.project,token:e.options.token},params:{}};return e._relayProtocolIsValid()&&(t.params=t.params||{},t.params.protocol=e.relayProtocol),Promise.resolve(e.execute(H(t))).then(function(t){e._bladeConnectResult=t})}catch(e){return Promise.reject(e)}},t._onSocketOpen=function(e){try{var t=this;D.debug("_onSocketOpen",e),t._idle=!1;var n=function(e,n){try{var r=Promise.resolve(t.authenticate()).then(function(){t._emptyRequestQueue(),t.dispatch(wt())})}catch(e){return n(e)}return r&&r.then?r.then(void 0,n):r}(0,function(e){D.error("Auth Error",e),t.dispatch(bt({error:e}))});return Promise.resolve(n&&n.then?n.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},t._onSocketError=function(e){D.debug("_onSocketError",e),this.dispatch(kt())},t._onSocketClose=function(e){D.debug("_onSocketClose",e),this.dispatch(St()),delete this._socket,this.connect()},t._onSocketMessage=function(e){var t=U(e.data);D.debug("RECV: \n",JSON.stringify(t,null,2),"\n");var n=this._requests.get(t.id);if(n){var r=n.rpcRequest,o=n.resolve,i=n.reject;this._requests.delete(t.id);var a=function(e){var t=e.response,n=t.result,r=void 0===n?{}:n,o=t.error;if(o)return{error:o};switch(e.request.method){case h.Connect:return{result:r};default:return F(t)}}({response:t,request:r}),u=a.result,c=a.error;return c?i(c):o(u)}switch(t.method){case h.Ping:return this._bladePingHandler(t);case h.Disconnect:this._idle=!0,this.execute(B({id:t.id,result:{}}));break;default:this.dispatch(Et(t))}},t.dispatch=function(e){throw new Error("Method not implemented")},t._relayProtocolIsValid=function(){var e;return this.signature&&(null==this||null==(e=this.relayProtocol)?void 0:e.split("_")[1])===this.signature},t._emptyRequestQueue=function(){var e=this;this._requestQueue.forEach(function(t){(0,t.resolve)(e.execute(t.msg))}),this._requestQueue=[]},t._bladePingHandler=function(e){try{var t,n=this;return clearTimeout(n._checkPingTimer),n._checkPingTimer=setTimeout(function(){D.error("No ping from remote.")},n._checkPingDelay),Promise.resolve(n.execute((r=e.id,o=null==e||null==(t=e.params)?void 0:t.timestamp,B({id:r,result:{timestamp:o||Date.now()/1e3}})))).then(function(){})}catch(e){return Promise.reject(e)}var r,o},n(e,[{key:"bladeConnectResult",get:function(){return this._bladeConnectResult}},{key:"relayProtocol",get:function(){var e,t,n;return null!=(e=null==(t=this._bladeConnectResult)||null==(n=t.result)?void 0:n.protocol)?e:""}},{key:"signature",get:function(){var e,t;return null==(e=this._bladeConnectResult)||null==(t=e.authorization)?void 0:t.signature}},{key:"logger",get:function(){return D}},{key:"connecting",get:function(){var e;return(null==(e=this._socket)?void 0:e.readyState)===p.CONNECTING}},{key:"connected",get:function(){var e;return(null==(e=this._socket)?void 0:e.readyState)===p.OPEN}},{key:"closing",get:function(){var e;return(null==(e=this._socket)?void 0:e.readyState)===p.CLOSING}},{key:"closed",get:function(){return!this._socket||this._socket.readyState===p.CLOSED}}]),e}()),Pt=function(e){return"@@redux-saga/"+e},_t=Pt("CANCEL_PROMISE"),xt=Pt("CHANNEL_END"),It=Pt("IO"),At=Pt("MATCH"),Ct=Pt("MULTICAST"),Tt=Pt("SAGA_ACTION"),jt=Pt("SELF_CANCELLATION"),Rt=Pt("TASK"),Nt=Pt("TASK_CANCEL"),Lt=Pt("TERMINATE"),Dt=Pt("LOCATION");function Mt(){return(Mt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var Ft=function(e){return null==e},Ut=function(e){return null!=e},Vt=function(e){return"function"==typeof e},qt=function(e){return"string"==typeof e},Bt=Array.isArray,Kt=function(e){return e&&Vt(e.then)},Ht=function(e){return e&&Vt(e.next)&&Vt(e.throw)},Wt=function e(t){return t&&(qt(t)||Gt(t)||Vt(t)||Bt(t)&&t.every(e))},zt=function(e){return e&&Vt(e.take)&&Vt(e.close)},Gt=function(e){return Boolean(e)&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype},Jt=function(e){return function(){return!0}}(),Xt=function(){},Yt=function(e){return e},$t=function(e,t){Mt(e,t),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach(function(n){e[n]=t[n]})};function Qt(e,t){var n=e.indexOf(t);n>=0&&e.splice(n,1)}function Zt(e){var t=!1;return function(){t||(t=!0,e())}}var en=function(e){throw e},tn=function(e){return{value:e,done:!0}};function nn(e,t,n){void 0===t&&(t=en),void 0===n&&(n="iterator");var r={meta:{name:n},next:e,throw:t,return:tn,isSagaIterator:!0};return"undefined"!=typeof Symbol&&(r[Symbol.iterator]=function(){return r}),r}function rn(e,t){var n=t.sagaStack;console.error(e),console.error(n)}var on=function(e){return Array.apply(null,new Array(e))},an=function(e){return function(t){return e(Object.defineProperty(t,Tt,{value:!0}))}},un=function(e){return e===Lt},cn=function(e){return e===Nt},sn=function(e){return un(e)||cn(e)};function fn(e,t){var n,r=Object.keys(e),o=r.length,i=0,a=Bt(e)?on(o):{},u={};return r.forEach(function(e){var r=function(r,u){n||(u||sn(r)?(t.cancel(),t(r,u)):(a[e]=r,++i===o&&(n=!0,t(a))))};r.cancel=Xt,u[e]=r}),t.cancel=function(){n||(n=!0,r.forEach(function(e){return u[e].cancel()}))},u}function ln(e){return{name:e.name||"anonymous",location:dn(e)}}function dn(e){return e[Dt]}var pn={isEmpty:Jt,put:Xt,take:Xt},hn="TAKE",vn="CALL",yn="FORK",mn=function(e,t){var n;return(n={})[It]=!0,n.combinator=!1,n.type=e,n.payload=t,n};function gn(e,t){return void 0===e&&(e="*"),Wt(e)?mn(hn,{pattern:e}):zt(n=e)&&n[Ct]&&Ut(t)&&Wt(t)?mn(hn,{channel:e,pattern:t}):zt(e)?mn(hn,{channel:e}):void 0;var n}function bn(e,t){return Ft(t)&&(t=e,e=void 0),mn("PUT",{channel:e,action:t})}function wn(e,t){var n,r=null;return Vt(e)?n=e:(Bt(e)?(r=e[0],n=e[1]):(r=e.context,n=e.fn),r&&qt(n)&&Vt(r[n])&&(n=r[n])),{context:r,fn:n,args:t}}function Sn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return mn(vn,wn(e,n))}function kn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return mn(yn,wn(e,n))}var En=[],On=0;function Pn(e){try{In(),e()}finally{An()}}function _n(e){En.push(e),On||(In(),Cn())}function xn(e){try{return In(),e()}finally{Cn()}}function In(){On++}function An(){On--}function Cn(){var e;for(An();!On&&void 0!==(e=En.shift());)Pn(e)}var Tn=function(e){return function(t){return e.some(function(e){return Dn(e)(t)})}},jn=function(e){return function(t){return e(t)}},Rn=function(e){return function(t){return t.type===String(e)}},Nn=function(e){return function(t){return t.type===e}},Ln=function(){return Jt};function Dn(e){var t="*"===e?Ln:qt(e)?Rn:Bt(e)?Tn:function(e){return Vt(e)&&e.hasOwnProperty("toString")}(e)?Rn:Vt(e)?jn:Gt(e)?Nn:null;if(null===t)throw new Error("invalid pattern: "+e);return t(e)}var Mn={type:xt},Fn=function(e){return e&&e.type===xt};function Un(e){void 0===e&&(e=function(e,t){void 0===e&&(e=10);var n=new Array(e),r=0,o=0,i=0,a=function(){if(0!=r){var t=n[i];return n[i]=null,r--,i=(i+1)%e,t}},u=function(){for(var e=[];r;)e.push(a());return e};return{isEmpty:function(){return 0==r},put:function(t){var a;r<e||(a=2*e,n=u(),r=n.length,o=n.length,i=0,n.length=a,e=a),function(t){n[o]=t,o=(o+1)%e,r++}(t)},take:a,flush:u}}(void 0));var t=!1,n=[];return{take:function(r){t&&e.isEmpty()?r(Mn):e.isEmpty()?(n.push(r),r.cancel=function(){Qt(n,r)}):r(e.take())},put:function(r){if(!t){if(0===n.length)return e.put(r);n.shift()(r)}},flush:function(n){t&&e.isEmpty()?n(Mn):n(e.flush())},close:function(){if(!t){t=!0;var e=n;n=[];for(var r=0,o=e.length;r<o;r++)(0,e[r])(Mn)}}}}function Vn(){var e,t,n,r,o,i,a=(t=!1,r=n=[],o=function(){r===n&&(r=n.slice())},i=function(){t=!0;var e=n=r;r=[],e.forEach(function(e){e(Mn)})},(e={})[Ct]=!0,e.put=function(e){if(!t)if(Fn(e))i();else for(var o=n=r,a=0,u=o.length;a<u;a++){var c=o[a];c[At](e)&&(c.cancel(),c(e))}},e.take=function(e,n){void 0===n&&(n=Ln),t?e(Mn):(e[At]=n,o(),r.push(e),e.cancel=Zt(function(){o(),Qt(r,e)}))},e.close=i,e),u=a.put;return a.put=function(e){e[Tt]?u(e):_n(function(){u(e)})},a}function qn(e,t){var n=e[_t];Vt(n)&&(t.cancel=n),e.then(t,function(e){t(e,!0)})}var Bn,Kn=0,Hn=function(){return++Kn};function Wn(e){e.isRunning()&&e.cancel()}var zn=((Bn={}).TAKE=function(e,t,n){var r=t.channel,o=void 0===r?e.channel:r,i=t.pattern,a=t.maybe,u=function(e){e instanceof Error?n(e,!0):!Fn(e)||a?n(e):n(Lt)};try{o.take(u,Ut(i)?Dn(i):null)}catch(e){return void n(e,!0)}n.cancel=u.cancel},Bn.PUT=function(e,t,n){var r=t.channel,o=t.action,i=t.resolve;_n(function(){var t;try{t=(r?r.put:e.dispatch)(o)}catch(e){return void n(e,!0)}i&&Kt(t)?qn(t,n):n(t)})},Bn.ALL=function(e,t,n,r){var o=r.digestEffect,i=Kn,a=Object.keys(t);if(0!==a.length){var u=fn(t,n);a.forEach(function(e){o(t[e],i,u[e],e)})}else n(Bt(t)?[]:{})},Bn.RACE=function(e,t,n,r){var o=r.digestEffect,i=Kn,a=Object.keys(t),u=Bt(t)?on(a.length):{},c={},s=!1;a.forEach(function(e){var t=function(t,r){s||(r||sn(t)?(n.cancel(),n(t,r)):(n.cancel(),s=!0,u[e]=t,n(u)))};t.cancel=Xt,c[e]=t}),n.cancel=function(){s||(s=!0,a.forEach(function(e){return c[e].cancel()}))},a.forEach(function(e){s||o(t[e],i,c[e],e)})},Bn.CALL=function(e,t,n,r){var o=t.context,i=t.fn,a=t.args,u=r.task;try{var c=i.apply(o,a);if(Kt(c))return void qn(c,n);if(Ht(c))return void Zn(e,c,u.context,Kn,ln(i),!1,n);n(c)}catch(e){n(e,!0)}},Bn.CPS=function(e,t,n){var r=t.context,o=t.fn,i=t.args;try{var a=function(e,t){Ft(e)?n(t):n(e,!0)};o.apply(r,i.concat(a)),a.cancel&&(n.cancel=a.cancel)}catch(e){n(e,!0)}},Bn.FORK=function(e,t,n,r){var o=t.fn,i=t.detached,a=r.task,u=function(e){var t=e.context,n=e.fn,r=e.args;try{var o=n.apply(t,r);if(Ht(o))return o;var i=!1;return nn(function(e){return i?{value:e,done:!0}:(i=!0,{value:o,done:!Kt(o)})})}catch(e){return nn(function(){throw e})}}({context:t.context,fn:o,args:t.args}),c=function(e,t){return e.isSagaIterator?{name:e.meta.name}:ln(t)}(u,o);xn(function(){var t=Zn(e,u,a.context,Kn,c,i,void 0);i?n(t):t.isRunning()?(a.queue.addTask(t),n(t)):t.isAborted()?a.queue.abort(t.error()):n(t)})},Bn.JOIN=function(e,t,n,r){var o=r.task,i=function(e,t){if(e.isRunning()){var n={task:o,cb:t};t.cancel=function(){e.isRunning()&&Qt(e.joiners,n)},e.joiners.push(n)}else e.isAborted()?t(e.error(),!0):t(e.result())};if(Bt(t)){if(0===t.length)return void n([]);var a=fn(t,n);t.forEach(function(e,t){i(e,a[t])})}else i(t,n)},Bn.CANCEL=function(e,t,n,r){t===jt?Wn(r.task):Bt(t)?t.forEach(Wn):Wn(t),n()},Bn.SELECT=function(e,t,n){var r=t.selector,o=t.args;try{n(r.apply(void 0,[e.getState()].concat(o)))}catch(e){n(e,!0)}},Bn.ACTION_CHANNEL=function(e,t,n){var r=t.pattern,o=Un(t.buffer),i=Dn(r),a=function t(n){Fn(n)||e.channel.take(t,i),o.put(n)},u=o.close;o.close=function(){a.cancel(),u()},e.channel.take(a,i),n(o)},Bn.CANCELLED=function(e,t,n,r){n(r.task.isCancelled())},Bn.FLUSH=function(e,t,n){t.flush(n)},Bn.GET_CONTEXT=function(e,t,n,r){n(r.task.context[t])},Bn.SET_CONTEXT=function(e,t,n,r){$t(r.task.context,t),n()},Bn);function Gn(e,t){return e+"?"+t}function Jn(e){var t=e.name,n=e.location;return n?t+"  "+Gn(n.fileName,n.lineNumber):t}function Xn(e){var t,n=(t=[]).concat.apply(t,e.map(function(e){return e.cancelledTasks}));return n.length?["Tasks cancelled due to error:"].concat(n).join("\n"):""}var Yn=null,$n=[],Qn=function(){Yn=null,$n.length=0};function Zn(e,t,n,r,o,i,a){var u=e.finalizeRunEffect(function(t,n,r){Kt(t)?qn(t,r):Ht(t)?Zn(e,t,s.context,n,o,!1,r):t&&t[It]?(0,zn[t.type])(e,t.payload,r,f):r(t)});l.cancel=Xt;var c={meta:o,cancel:function(){0===c.status&&(c.status=1,l(Nt))},status:0},s=function(e,t,n,r,o,i,a){var u;void 0===a&&(a=Xt);var c,s,f=0,l=null,d=[],p=Object.create(n),h=function(e,t,n){var r,o=[],i=!1;function a(e){d.push.apply(d,h.getTasks().map(function(e){return e.meta.name})),c(),n(e,!0)}function u(t){o.push(t),t.cont=function(u,c){i||(Qt(o,t),t.cont=Xt,c?a(u):(t===e&&(r=u),o.length||(i=!0,n(r))))}}function c(){i||(i=!0,o.forEach(function(e){e.cont=Xt,e.cancel()}),o=[])}return u(e),{addTask:u,cancelAll:c,abort:a,getTasks:function(){return o}}}(t,0,v);function v(t,n){if(n){if(f=2,(h={meta:o,cancelledTasks:d}).crashedEffect=Yn,$n.push(h),y.isRoot){var r=(a=$n[0],u=$n.slice(1),p=a.crashedEffect?(i=dn(a.crashedEffect))?i.code+"  "+Gn(i.fileName,i.lineNumber):"":null,["The above error occurred in task "+Jn(a.meta)+(p?" \n when executing effect "+p:"")].concat(u.map(function(e){return"    created by "+Jn(e.meta)}),[Xn($n)]).join("\n"));Qn(),e.onError(t,{sagaStack:r})}s=t,l&&l.reject(t)}else t===Nt?f=1:1!==f&&(f=3),c=t,l&&l.resolve(t);var i,a,u,p,h;y.cont(t,n),y.joiners.forEach(function(e){e.cb(t,n)}),y.joiners=null}var y=((u={})[Rt]=!0,u.id=r,u.meta=o,u.isRoot=i,u.context=p,u.joiners=[],u.queue=h,u.cancel=function(){0===f&&(f=1,h.cancelAll(),v(Nt,!1))},u.cont=a,u.end=v,u.setContext=function(e){$t(p,e)},u.toPromise=function(){return l||((e={}).promise=new Promise(function(t,n){e.resolve=t,e.reject=n}),l=e,2===f?l.reject(s):0!==f&&l.resolve(c)),l.promise;var e},u.isRunning=function(){return 0===f},u.isCancelled=function(){return 1===f||0===f&&1===t.status},u.isAborted=function(){return 2===f},u.result=function(){return c},u.error=function(){return s},u);return y}(e,c,n,r,o,i,a),f={task:s,digestEffect:d};return a&&(a.cancel=s.cancel),l(),s;function l(e,n){try{var o;n?(o=t.throw(e),Qn()):cn(e)?(c.status=1,l.cancel(),o=Vt(t.return)?t.return(Nt):{done:!0,value:Nt}):o=un(e)?Vt(t.return)?t.return():{done:!0}:t.next(e),o.done?(1!==c.status&&(c.status=3),c.cont(o.value)):d(o.value,r,l)}catch(e){if(1===c.status)throw e;c.status=2,c.cont(e,!0)}}function d(t,n,r,o){void 0===o&&(o="");var i,a=Hn();function c(n,o){i||(i=!0,r.cancel=Xt,e.sagaMonitor&&(o?e.sagaMonitor.effectRejected(a,n):e.sagaMonitor.effectResolved(a,n)),o&&function(e){Yn=e}(t),r(n,o))}e.sagaMonitor&&e.sagaMonitor.effectTriggered({effectId:a,parentEffectId:n,label:o,effect:t}),c.cancel=Xt,r.cancel=function(){i||(i=!0,c.cancel(),c.cancel=Xt,e.sagaMonitor&&e.sagaMonitor.effectCancelled(a))},u(t,a,c)}}function er(e,t){for(var n=e.channel,r=void 0===n?Vn():n,o=e.dispatch,i=e.getState,a=e.context,u=void 0===a?{}:a,c=e.sagaMonitor,s=e.effectMiddlewares,f=e.onError,l=void 0===f?rn:f,d=arguments.length,p=new Array(d>2?d-2:0),h=2;h<d;h++)p[h-2]=arguments[h];var v,y=t.apply(void 0,p),m=Hn();if(c&&(c.rootSagaStarted=c.rootSagaStarted||Xt,c.effectTriggered=c.effectTriggered||Xt,c.effectResolved=c.effectResolved||Xt,c.effectRejected=c.effectRejected||Xt,c.effectCancelled=c.effectCancelled||Xt,c.actionDispatched=c.actionDispatched||Xt,c.rootSagaStarted({effectId:m,saga:t,args:p})),s){var g=Qe.apply(void 0,s);v=function(e){return function(t,n,r){return g(function(t){return e(t,n,r)})(t)}}}else v=Yt;var b={channel:r,dispatch:an(o),getState:i,sagaMonitor:c,onError:l,finalizeRunEffect:v};return xn(function(){var e=Zn(b,y,u,m,ln(t),!0,void 0);return c&&c.effectResolved(m,e),e})}function tr(e){var t,n=void 0===e?{}:e,r=n.context,o=void 0===r?{}:r,i=n.channel,a=void 0===i?Vn():i,u=n.sagaMonitor,c=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t.indexOf(n=i[r])>=0||(o[n]=e[n]);return o}(n,["context","channel","sagaMonitor"]);function s(e){return t=er.bind(null,Mt({},c,{context:o,channel:a,dispatch:e.dispatch,getState:e.getState,sagaMonitor:u})),function(e){return function(t){u&&u.actionDispatched&&u.actionDispatched(t);var n=e(t);return a.put(t),n}}}return s.run=function(){return t.apply(void 0,arguments)},s.setContext=function(e){$t(o,e)},s}var nr={byId:{}},rr=vt({name:"components",initialState:nr,reducers:{upsert:function(e,t){var n=t.payload;n.id in e.byId?Object.keys(n).forEach(function(t){e.byId[n.id][t]=n[t]}):e.byId[n.id]=n},executeSuccess:function(e,t){var n=t.payload,r=n.componentId,o=n.requestId,i=n.response;e.byId[r]&&(e.byId[r].responses=e.byId[r].responses||{},e.byId[r].responses[o]=i)},executeFailure:function(e,t){var n=t.payload,r=n.componentId,o=n.requestId,i=n.error,a=n.action;e.byId[r]&&(e.byId[r].errors=e.byId[r].errors||{},e.byId[r].errors[o]={action:a,jsonrpc:i})}},extraReducers:function(e){e.addCase(mt.type,function(){return nr})}}),or=rr.actions,ir=rr.reducer,ar={protocol:"",iceServers:[],authStatus:"unknown",authError:void 0},ur=vt({name:"session",initialState:ar,reducers:{connected:function(e,t){var n,r,o,i,a=t.payload;e.authStatus="authorized",e.protocol=null!=(n=null==a||null==(r=a.result)?void 0:r.protocol)?n:"",e.iceServers=null!=(o=null==a||null==(i=a.result)?void 0:i.iceServers)?o:[]}},extraReducers:function(e){e.addCase(mt.type,function(){return ar}),e.addCase(bt.type,function(e,t){var n=t.payload;e.authStatus="unauthorized",e.authError=n.error})}}),cr=ur.actions,sr=Je({components:ir,session:ur.reducer});function fr(e){var t,n,r;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:n=function(n){var r,o,i,a,u,c,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=(r=n.payload).componentId,i=r.requestId,a=r.method,u=r.params,t.prev=1,c=W({id:i,protocol:e.relayProtocol,method:a,params:u}),t.next=5,Sn(e.execute,c);case 5:if(s=t.sent,!o||!i){t.next=9;break}return t.next=9,bn(or.executeSuccess({componentId:o,requestId:i,response:s}));case 9:t.next=17;break;case 11:if(t.prev=11,t.t0=t.catch(1),D.warn("worker error",o,t.t0),!o||!i){t.next=17;break}return t.next=17,bn(or.executeFailure({componentId:o,requestId:i,action:n,error:t.t0}));case 17:case"end":return t.stop()}},t,null,[[1,11]])},t=regeneratorRuntime.mark(n);case 2:return o.next=5,gn(gt.type);case 5:return r=o.sent,o.next=8,kn(n,r);case 8:o.next=2;break;case 10:case"end":return o.stop()}},b)}function lr(e){var t,n,r,o,i,a,u,c,s,f,l,d;return regeneratorRuntime.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:l=function(e){var t,n,r;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(D.debug("Inbound WebSocket Message",e),e.type===Et.type){o.next=5;break}return o.next=4,bn(e);case 4:return o.abrupt("return");case 5:r=(t=e.payload).params,o.t0=n=t.method,o.next=o.t0===h.Broadcast?9:12;break;case 9:return o.next=11,kn(f,r);case 11:return o.abrupt("break",13);case 12:return o.abrupt("return",D.debug("Unknown message: "+n,e));case 13:case"end":return o.stop()}},o)},f=function(e){var t,n,o,a,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n=(t=e||{}).event,a=(o=t.params).event_type,u=o.node_id,t.protocol===i.relayProtocol){r.next=4;break}return r.abrupt("return",D.error("Session protocol mismatch."));case 4:r.t0=n,r.next="queuing.relay.events"===r.t0?7:"conference"===r.t0?15:"queuing.relay.tasks"===r.t0?19:"queuing.relay.messaging"===r.t0?21:23;break;case 7:if("webrtc.message"!==a){r.next=13;break}return o.params.params.nodeId=u,r.next=11,kn(c,o.params);case 11:r.next=14;break;case 13:D.debug("Relay Calling event:",o);case 14:return r.abrupt("break",24);case 15:return D.debug("Conference event:",o),r.next=18,kn(s,o);case 18:return r.abrupt("break",24);case 19:case 21:return D.debug("Relay Task event:",o),r.abrupt("break",24);case 23:return r.abrupt("return",D.debug("Unknown broadcast event: "+n,e));case 24:case"end":return r.stop()}},r)},s=function(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e.event_type,t.next="room.subscribed"===t.t0?3:8;break;case 3:return t.next=5,bn(or.upsert({id:e.params.call_id,roomId:e.params.room.room_id,roomSessionId:e.params.room.room_session_id,memberId:e.params.member_id}));case 5:return t.next=7,bn(u,{type:"room.joined",payload:e.params});case 7:return t.abrupt("break",8);case 8:return t.next=10,bn(u,{type:e.event_type,payload:e.params});case 10:case"end":return t.stop()}},n)},c=function(e){var n,r,o,a,u,c,s,f,l,d,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:D.debug("vertoWorker",e),n=e.id,u=(a=void 0===(o=e.params)?{}:o).callID,c=a.nodeId,t.t0=r=e.method,t.next=t.t0===v.Media?6:t.t0===v.Answer?10:t.t0===v.Bye?17:t.t0===v.Ping?21:t.t0===v.Punt?24:t.t0===v.Info?25:t.t0===v.ClientReady?26:t.t0===v.Announce?27:28;break;case 6:return s={id:u,state:y.Early,remoteSDP:a.sdp,nodeId:c},t.next=9,bn(or.upsert(s));case 9:return t.abrupt("break",29);case 10:return f={id:u,state:y.Active,nodeId:c},null!=a&&a.sdp&&(f.remoteSDP=a.sdp),t.next=14,bn(or.upsert(f));case 14:return t.next=16,bn(gt({method:"video.message",params:{message:z(n,r),node_id:c}}));case 16:return t.abrupt("break",29);case 17:return p={id:u,state:y.Hangup,nodeId:c,byeCause:null!=(l=null==a?void 0:a.cause)?l:"",byeCauseCode:null!=(d=null==a?void 0:a.causeCode)?d:0,redirectDestination:null==a?void 0:a.redirectDestination},t.next=20,bn(or.upsert(p));case 20:return t.abrupt("break",29);case 21:return t.next=23,bn(gt({method:"video.message",params:{message:z(n,r),node_id:c}}));case 23:return t.abrupt("break",29);case 24:return t.abrupt("return",i.disconnect());case 25:return t.abrupt("return",D.debug("Verto Info",a));case 26:return t.abrupt("return",D.debug("Verto ClientReady",a));case 27:return t.abrupt("return",D.debug("Verto Announce",a));case 28:return t.abrupt("return",D.debug("Unknown Verto method: "+r,a));case 29:case"end":return t.stop()}},t)},t=regeneratorRuntime.mark(c),n=regeneratorRuntime.mark(s),r=regeneratorRuntime.mark(f),o=regeneratorRuntime.mark(l),i=e.session,a=e.sessionChannel,u=e.pubSubChannel;case 6:p.prev=7;case 8:return p.next=11,gn(a);case 11:return d=p.sent,p.next=14,kn(l,d);case 14:p.next=8;break;case 16:p.next=21;break;case 18:p.prev=18,p.t0=p.catch(7),console.error("sessionChannelWorker error:",p.t0);case 21:return p.prev=21,console.warn("sessionChannelWorker finally"),p.finish(21);case 24:p.next=6;break;case 26:case"end":return p.stop()}},w,null,[[7,18,21,24]])}function dr(e){return function(t,n){void 0===n&&(n=pn);var r,o,i=!1,a=Un(n),u=function(){i||(i=!0,Vt(r)&&r(),a.close())};return r=Zt((o=function(e){Fn(e)?u():a.put(e)},e.dispatch=function(e){o(e)},r=function(){D.debug("sessionChannel unsubscribe"),e.disconnect()})),i&&r(),{take:a.take,flush:a.flush,close:u}}()}function pr(e){var t,n,r;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:t=e.pubSubChannel,n=e.emitter;case 1:return o.next=4,gn(t);case 4:n.emit((r=o.sent).type,r.payload),o.next=1;break;case 10:case"end":return o.stop()}},S)}function hr(e,t){var n,r,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n=new e(t),window.__session=n,i.next=4,Sn(dr,n);case 4:return r=i.sent,i.next=7,Sn(Un);case 7:return o=i.sent,i.next=10,kn(lr,{session:n,sessionChannel:r,pubSubChannel:o});case 10:return n.connect(),i.next=13,gn([wt.type,bt.type]);case 13:if(i.sent.type!==bt.type){i.next=18;break}throw new Error("Auth Error");case 18:return i.next=20,kn(yr,{session:n,sessionChannel:r,pubSubChannel:o,userOptions:t});case 20:case"end":return i.stop()}},k)}function vr(e){var t,n,r,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.session,n=e.sessionChannel,r=e.pubSubChannel,o=e.userOptions,i.next=3,gn([wt.type,kt.type,St.type]);case 3:i.t0=i.sent.type,i.next=i.t0===wt.type?7:i.t0===kt.type?10:i.t0===St.type?13:16;break;case 7:return i.next=9,kn(yr,{session:t,sessionChannel:n,pubSubChannel:r,userOptions:o});case 9:return i.abrupt("break",16);case 10:return i.next=12,bn(r,{type:"socket.error",payload:{}});case 12:return i.abrupt("break",16);case 13:return i.next=15,bn(r,{type:"socket.closed",payload:{}});case 15:return i.abrupt("break",16);case 16:case"end":return i.stop()}},E)}function yr(e){var t,n,r,o,i,a,u;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.session,n=e.sessionChannel,r=e.pubSubChannel,o=e.userOptions,c.next=3,bn(cr.connected(t.bladeConnectResult));case 3:return c.next=5,kn(pr,{pubSubChannel:r,emitter:o.emitter});case 5:return i=c.sent,c.next=8,kn(fr,t);case 8:return a=c.sent,c.next=11,kn(vr,e);case 11:return u=c.sent,c.next=14,gn(mt.type);case 14:i.cancel(),u.cancel(),a.cancel(),r.close(),n.close();case 19:case"end":return c.stop()}},O)}var mr,gr,br,wr,Sr,kr,Er=function(e){function t(n,r){var o;return(o=e.call(this,r)||this).code=n,o.message=r,o.name="AuthError",Object.setPrototypeOf(f(o),t.prototype),o}return o(t,e),t}(s(Error)),Or=function(){function e(e,t){this.options=e,this.store=t}var t=e.prototype;return t.on=function(){var e;return(e=this.emitter).on.apply(e,[].slice.call(arguments))},t.once=function(){var e;return(e=this.emitter).once.apply(e,[].slice.call(arguments))},t.off=function(){var e;return(e=this.emitter).off.apply(e,[].slice.call(arguments))},t.emit=function(){var e;return(e=this.emitter).emit.apply(e,[].slice.call(arguments))},t.removeAllListeners=function(){var e;return(e=this.emitter).removeAllListeners.apply(e,[].slice.call(arguments))},t.connect=function(){var e=this;return new Promise(function(t,n){var r=e.store.subscribe(function(){var o=e.store.getState().session,i=o.authStatus,a=o.authError;if("authorized"===i)t(e),r();else if("unauthorized"===i){var u=a?new Er(a.code,a.message):new Error("Unauthorized");n(u),r()}});e.store.dispatch(yt())})},t.disconnect=function(){this.store.dispatch(mt())},n(e,[{key:"emitter",get:function(){return this.options.emitter}}]),e}(),Pr=["on","off","once","removeAllListeners","emit"],_r=function(e){if(!e.emitter)return n={},r=Symbol.for("sw-once-key"),new(function(){function e(){}var t=e.prototype;return t.on=function(e,t,o){return void 0===o&&(o=!1),n[e]||(n[e]=[]),n[e].push(t),t[r]=o,this},t.once=function(e,t){return this.on(e,t,!0)},t.off=function(e,t){if(void 0===t&&(t=null),!n[e])return this;if(!t)return delete n[e],this;for(var r=n[e];r.includes(t);)r.splice(r.indexOf(t),1);return r.length||delete n[e],this},t.emit=function(e){if(!n[e])return!1;for(var t,o=[],i=d(n[e]);!(t=i()).done;){var a=t.value;a.apply(void 0,[].slice.call(arguments,1)),a[r]&&o.push(a)}for(var u=0,c=o;u<c.length;u++)this.off(e,c[u]);return!0},t.removeAllListeners=function(){for(var e in n)this.off(e);return this},e}());if((t=e.emitter)&&"object"==typeof t&&Pr.every(function(e){return e in t}))return e.emitter;var t,n,r;throw new Error("The passed `emitter` doesn't expose the correct interface. Please check that your custom `emitter` comply with the `Emitter` interface.")};function xr(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}function Ir(){return(Ir=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ar(){return(Ar=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}P({},{__proto__:null,getIceServers:function(e){var t,n=e.session;return null!=(t=null==n?void 0:n.iceServers)?t:[]}}),function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED"}(mr||(mr={})),function(e){e.Broadcast="blade.broadcast",e.Disconnect="blade.disconnect",e.Connect="blade.connect",e.Ping="blade.ping",e.Reauthenticate="blade.reauthenticate",e.Execute="blade.execute"}(gr||(gr={})),function(e){e.Invite="verto.invite",e.Attach="verto.attach",e.Answer="verto.answer",e.Info="verto.info",e.Display="verto.display",e.Media="verto.media",e.Event="verto.event",e.Bye="verto.bye",e.Punt="verto.punt",e.Broadcast="verto.broadcast",e.Subscribe="verto.subscribe",e.Unsubscribe="verto.unsubscribe",e.ClientReady="verto.clientReady",e.Modify="verto.modify",e.MediaParams="verto.mediaParams",e.Prompt="verto.prompt",e.JsApi="jsapi",e.Stats="verto.stats",e.Ping="verto.ping",e.Announce="verto.announce"}(br||(br={})),function(e){e.New="new",e.Requesting="requesting",e.Trying="trying",e.Recovering="recovering",e.Ringing="ringing",e.Answering="answering",e.Early="early",e.Active="active",e.Held="held",e.Hangup="hangup",e.Destroy="destroy",e.Purge="purge"}(wr||(wr={})),function(e){e.MemberAudioMute="conference.member.audio_mute",e.MemberAudioUnmute="conference.member.audio_unmute",e.MemberVideoMute="conference.member.video_mute",e.MemberVideoUnmute="conference.member.video_unmute"}(Sr||(Sr={}));var Cr=new Uint8Array(16);function Tr(){if(!kr&&!(kr="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return kr(Cr)}var jr=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Rr(e){return"string"==typeof e&&jr.test(e)}for(var Nr=[],Lr=0;Lr<256;++Lr)Nr.push((Lr+256).toString(16).substr(1));function Dr(e,t,n){var r=(e=e||{}).random||(e.rng||Tr)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Nr[e[t+0]]+Nr[e[t+1]]+Nr[e[t+2]]+Nr[e[t+3]]+"-"+Nr[e[t+4]]+Nr[e[t+5]]+"-"+Nr[e[t+6]]+Nr[e[t+7]]+"-"+Nr[e[t+8]]+Nr[e[t+9]]+"-"+Nr[e[t+10]]+Nr[e[t+11]]+Nr[e[t+12]]+Nr[e[t+13]]+Nr[e[t+14]]+Nr[e[t+15]]).toLowerCase();if(!Rr(n))throw TypeError("Stringified UUID is invalid");return n}(r)}var Mr="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Fr=function(e){var t={exports:{}};return function(e){var t,n;t=Mr,n=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function o(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function i(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?i:void 0!==console[r]?o(console,r):void 0!==console.log?o(console,"log"):e)}function u(t,n){for(var o=0;o<r.length;o++){var i=r[o];this[i]=o<t?e:this.methodFactory(i,t,n)}this.log=this.debug}function c(e,n,r){return function(){typeof console!==t&&(u.call(this,n,r),this[e].apply(this,arguments))}}function s(e,t,n){return a(e)||c.apply(this,arguments)}function f(e,n,o){var i,a=this,c="loglevel";function f(){var e;if(typeof window!==t&&c){try{e=window.localStorage[c]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(c)+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(e){}return void 0===a.levels[e]&&(e=void 0),e}}"string"==typeof e?c+=":"+e:"symbol"==typeof e&&(c=void 0),a.name=e,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=o||s,a.getLevel=function(){return i},a.setLevel=function(n,o){if("string"==typeof n&&void 0!==a.levels[n.toUpperCase()]&&(n=a.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(i=n,!1!==o&&function(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&c){try{return void(window.localStorage[c]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(e){}}}(n),u.call(a,n,e),typeof console===t&&n<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(e){f()||a.setLevel(e,!1)},a.enableAll=function(e){a.setLevel(a.levels.TRACE,e)},a.disableAll=function(e){a.setLevel(a.levels.SILENT,e)};var l=f();null==l&&(l=null==n?"WARN":n),a.setLevel(l,!1)}var l=new f,d={};l.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new f(e,l.getLevel(),l.methodFactory)),t};var p=typeof window!==t?window.log:void 0;return l.noConflict=function(){return typeof window!==t&&window.log===l&&(window.log=p),l},l.getLoggers=function(){return d},l.default=l,l},e.exports?e.exports=n():t.log=n()}(t),t.exports}(),Ur=function(){return(new Date).toISOString().replace("T"," ").replace("Z","")},Vr=Fr.getLogger("signalwire"),qr=Vr.methodFactory;Vr.methodFactory=function(e,t,n){var r=qr(e,t,n);return function(){for(var e=[Ur(),"-"],t=0;t<arguments.length;t++)e.push(arguments[t]);r.apply(void 0,e)}},Vr.setLevel(Vr.getLevel());var Br={id:"callID",destinationNumber:"destination_number",remoteCallerName:"remote_caller_id_name",remoteCallerNumber:"remote_caller_id_number",callerName:"caller_id_name",callerNumber:"caller_id_number"},Kr=function(e){if(e.hasOwnProperty("dialogParams")){var t=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t.indexOf(n=i[r])>=0||(o[n]=e[n]);return o}(e.dialogParams,["remoteSdp","localStream","remoteStream"]);for(var n in Br)n&&t.hasOwnProperty(n)&&(t[Br[n]]=t[n],delete t[n]);e.dialogParams=t}return e},Hr=function(e){return function(t){return void 0===t&&(t={}),function(e){var t;return Ar({jsonrpc:"2.0",id:null!=(t=e.id)?t:Dr()},e)}({method:e,params:Kr(t)})}},Wr=Hr(br.Invite),zr=Hr(br.Bye),Gr=Hr(br.Info);function Jr(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map(function(e){return"'"+e+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Xr(e){return!!e&&!!e[Do]}function Yr(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return"function"==typeof n&&Function.toString.call(n)===Mo}(e)||Array.isArray(e)||!!e[Lo]||!!e.constructor[Lo]||no(e)||ro(e))}function $r(e,t,n){void 0===n&&(n=!1),0===Qr(e)?(n?Object.keys:Fo)(e).forEach(function(r){n&&"symbol"==typeof r||t(r,e[r],e)}):e.forEach(function(n,r){return t(r,n,e)})}function Qr(e){var t=e[Do];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:no(e)?2:ro(e)?3:0}function Zr(e,t){return 2===Qr(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function eo(e,t,n){var r=Qr(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function to(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function no(e){return To&&e instanceof Map}function ro(e){return jo&&e instanceof Set}function oo(e){return e.o||e.t}function io(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=Uo(e);delete t[Do];for(var n=Fo(t),r=0;r<n.length;r++){var o=n[r],i=t[o];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(t[o]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[o]})}return Object.create(Object.getPrototypeOf(e),t)}function ao(e,t){return void 0===t&&(t=!1),co(e)||Xr(e)||!Yr(e)||(Qr(e)>1&&(e.set=e.add=e.clear=e.delete=uo),Object.freeze(e),t&&$r(e,function(e,t){return ao(t,!0)},!0)),e}function uo(){Jr(2)}function co(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function so(e){var t=Vo[e];return t||Jr(18,e),t}function fo(){return Ao}function lo(e,t){t&&(so("Patches"),e.u=[],e.s=[],e.v=t)}function po(e){ho(e),e.p.forEach(yo),e.p=null}function ho(e){e===Ao&&(Ao=e.l)}function vo(e){return Ao={p:[],l:Ao,h:e,m:!0,_:0}}function yo(e){var t=e[Do];0===t.i||1===t.i?t.j():t.g=!0}function mo(e,t){t._=t.p.length;var n=t.p[0],r=void 0!==e&&e!==n;return t.h.O||so("ES5").S(t,e,r),r?(n[Do].P&&(po(t),Jr(4)),Yr(e)&&(e=go(t,e),t.l||wo(t,e)),t.u&&so("Patches").M(n[Do],e,t.u,t.s)):e=go(t,n,[]),po(t),t.u&&t.v(t.u,t.s),e!==No?e:void 0}function go(e,t,n){if(co(t))return t;var r=t[Do];if(!r)return $r(t,function(o,i){return bo(e,r,t,o,i,n)},!0),t;if(r.A!==e)return t;if(!r.P)return wo(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var o=4===r.i||5===r.i?r.o=io(r.k):r.o;$r(3===r.i?new Set(o):o,function(t,i){return bo(e,r,o,t,i,n)}),wo(e,o,!1),n&&e.u&&so("Patches").R(r,n,e.u,e.s)}return r.o}function bo(e,t,n,r,o,i){if(Xr(o)){var a=go(e,o,i&&t&&3!==t.i&&!Zr(t.D,r)?i.concat(r):void 0);if(eo(n,r,a),!Xr(a))return;e.m=!1}if(Yr(o)&&!co(o)){if(!e.h.F&&e._<1)return;go(e,o),t&&t.A.l||wo(e,o)}}function wo(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&ao(t,n)}function So(e,t){var n=e[Do];return(n?oo(n):e)[t]}function ko(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function Eo(e){e.P||(e.P=!0,e.l&&Eo(e.l))}function Oo(e){e.o||(e.o=io(e.t))}function Po(e,t,n){var r=no(t)?so("MapSet").N(t,n):ro(t)?so("MapSet").T(t,n):e.O?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:fo(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},o=r,i=qo;n&&(o=[r],i=Bo);var a=Proxy.revocable(o,i),u=a.revoke,c=a.proxy;return r.k=c,r.j=u,c}(t,n):so("ES5").J(t,n);return(n?n.A:fo()).p.push(r),r}function _o(e){return Xr(e)||Jr(22,e),function e(t){if(!Yr(t))return t;var n,r=t[Do],o=Qr(t);if(r){if(!r.P&&(r.i<4||!so("ES5").K(r)))return r.t;r.I=!0,n=xo(t,o),r.I=!1}else n=xo(t,o);return $r(n,function(t,o){r&&function(e,t){return 2===Qr(e)?e.get(t):e[t]}(r.t,t)===o||eo(n,t,e(o))}),3===o?new Set(n):n}(e)}function xo(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return io(e)}var Io,Ao,Co="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),To="undefined"!=typeof Map,jo="undefined"!=typeof Set,Ro="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,No=Co?Symbol.for("immer-nothing"):((Io={})["immer-nothing"]=!0,Io),Lo=Co?Symbol.for("immer-draftable"):"__$immer_draftable",Do=Co?Symbol.for("immer-state"):"__$immer_state",Mo=""+Object.prototype.constructor,Fo="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,Uo=Object.getOwnPropertyDescriptors||function(e){var t={};return Fo(e).forEach(function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)}),t},Vo={},qo={get:function(e,t){if(t===Do)return e;var n=oo(e);if(!Zr(n,t))return function(e,t,n){var r,o=ko(t,n);return o?"value"in o?o.value:null===(r=o.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!Yr(r)?r:r===So(e.t,t)?(Oo(e),e.o[t]=Po(e.A.h,r,e)):r},has:function(e,t){return t in oo(e)},ownKeys:function(e){return Reflect.ownKeys(oo(e))},set:function(e,t,n){var r=ko(oo(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var o=So(oo(e),t),i=null==o?void 0:o[Do];if(i&&i.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(to(n,o)&&(void 0!==n||Zr(e.t,t)))return!0;Oo(e),Eo(e)}return e.o[t]===n&&"number"!=typeof n||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==So(e.t,t)||t in e.t?(e.D[t]=!1,Oo(e),Eo(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=oo(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){Jr(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){Jr(12)}},Bo={};$r(qo,function(e,t){Bo[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),Bo.deleteProperty=function(e,t){return qo.deleteProperty.call(this,e[0],t)},Bo.set=function(e,t,n){return qo.set.call(this,e[0],t,n,e[0])};var Ko=new(function(){function e(e){var t=this;this.O=Ro,this.F=!0,this.produce=function(e,n,r){if("function"==typeof e&&"function"!=typeof n){var o=n;n=e;var i=t;return function(e){var t=this;void 0===e&&(e=o);for(var r=arguments.length,a=Array(r>1?r-1:0),u=1;u<r;u++)a[u-1]=arguments[u];return i.produce(e,function(e){var r;return(r=n).call.apply(r,[t,e].concat(a))})}}var a;if("function"!=typeof n&&Jr(6),void 0!==r&&"function"!=typeof r&&Jr(7),Yr(e)){var u=vo(t),c=Po(t,e,void 0),s=!0;try{a=n(c),s=!1}finally{s?po(u):ho(u)}return"undefined"!=typeof Promise&&a instanceof Promise?a.then(function(e){return lo(u,r),mo(e,u)},function(e){throw po(u),e}):(lo(u,r),mo(a,u))}if(!e||"object"!=typeof e){if((a=n(e))===No)return;return void 0===a&&(a=e),t.F&&ao(a,!0),a}Jr(21,e)},this.produceWithPatches=function(e,n){return"function"==typeof e?function(n){for(var r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return t.produceWithPatches(n,function(t){return e.apply(void 0,[t].concat(o))})}:[t.produce(e,n,function(e,t){r=e,o=t}),r,o];var r,o},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){Yr(e)||Jr(8),Xr(e)&&(e=_o(e));var t=vo(this),n=Po(this,e,void 0);return n[Do].C=!0,ho(t),n},t.finishDraft=function(e,t){var n=(e&&e[Do]).A;return lo(n,t),mo(void 0,n)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!Ro&&Jr(20),this.O=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}var o=so("Patches").$;return Xr(e)?o(e,t):this.produce(e,function(e){return o(e,t.slice(n+1))})},e}()),Ho=Ko.produce;Ko.produceWithPatches.bind(Ko),Ko.setAutoFreeze.bind(Ko),Ko.setUseProxies.bind(Ko),Ko.applyPatches.bind(Ko),Ko.createDraft.bind(Ko),Ko.finishDraft.bind(Ko),function(e){var t,n=("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()).Symbol;"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable"}();var Wo=function(){return Math.random().toString(36).substring(7).split("").join(".")},zo={INIT:"@@redux/INIT"+Wo(),REPLACE:"@@redux/REPLACE"+Wo(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Wo()}};function Go(e,t){return e===t}function Jo(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var r=t.length,o=0;o<r;o++)if(!e(t[o],n[o]))return!1;return!0}function Xo(){return(Xo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Yo(e,t){function n(){if(t){var n=t.apply(void 0,arguments);if(!n)throw new Error("prepareAction did not return an object");return Xo({type:e,payload:n.payload},"meta"in n&&{meta:n.meta},{},"error"in n&&{error:n.error})}return{type:e,payload:arguments.length<=0?void 0:arguments[0]}}return n.toString=function(){return""+e},n.type=e,n.match=function(t){return t.type===e},n}function $o(e){var t,n={},r=[],o={addCase:function(e,t){var r="string"==typeof e?e:e.type;if(r in n)throw new Error("addCase cannot be called with two reducers for the same action type");return n[r]=t,o},addMatcher:function(e,t){return r.push({matcher:e,reducer:t}),o},addDefaultCase:function(e){return t=e,o}};return e(o),[n,r,t]}function Qo(e){var t=e.name,n=e.initialState;if(!t)throw new Error("`name` is a required option for createSlice");var r=e.reducers||{},o=void 0===e.extraReducers?[]:"function"==typeof e.extraReducers?$o(e.extraReducers):[e.extraReducers],i=o[0],a=void 0===i?{}:i,u=o[1],c=void 0===u?[]:u,s=o[2],f=void 0===s?void 0:s,l=Object.keys(r),d={},p={},h={};l.forEach(function(e){var n,o,i=r[e],a=t+"/"+e;"reducer"in i?(n=i.reducer,o=i.prepare):n=i,d[e]=n,p[a]=n,h[e]=o?Yo(a,o):Yo(a)});var v=function(e,t,n,r){void 0===n&&(n=[]);var o="function"==typeof t?$o(t):[t,n,r],i=o[0],a=o[1],u=o[2],c=Ho(e,function(){});return function(e,t){void 0===e&&(e=c);var n=[i[t.type]].concat(a.filter(function(e){return(0,e.matcher)(t)}).map(function(e){return e.reducer}));return 0===n.filter(function(e){return!!e}).length&&(n=[u]),n.reduce(function(e,n){if(n){if(Xr(e)){var r=n(e,t);return void 0===r?e:r}if(Yr(e))return Ho(e,function(e){return n(e,t)});var o=n(e,t);if(void 0===o){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return o}return e},e)}}(n,Xo({},a,{},p),c,f);return{name:t,reducer:v,actions:h,caseReducers:d}}!function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r]}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Go,n=null,r=null;return function(){return Jo(t,n,arguments)||(r=e.apply(null,arguments)),n=arguments,r}}),"undefined"==typeof Symbol||Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")),"undefined"==typeof Symbol||Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")),function(){function e(e,t){var n=o[e];return n?n.enumerable=t:o[e]=n={configurable:!0,enumerable:t,get:function(){return qo.get(this[Do],e)},set:function(t){qo.set(this[Do],e,t)}},n}function t(e){for(var t=e.length-1;t>=0;t--){var o=e[t][Do];if(!o.P)switch(o.i){case 5:r(o)&&Eo(o);break;case 4:n(o)&&Eo(o)}}}function n(e){for(var t=e.t,n=e.k,r=Fo(n),o=r.length-1;o>=0;o--){var i=r[o];if(i!==Do){var a=t[i];if(void 0===a&&!Zr(t,i))return!0;var u=n[i],c=u&&u[Do];if(c?c.t!==a:!to(u,a))return!0}}var s=!!t[Do];return r.length!==Fo(t).length+(s?0:1)}function r(e){var t=e.k;if(t.length!==e.t.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!n||n.get)}var o={};!function(e,t){Vo.ES5||(Vo.ES5=t)}(0,{J:function(t,n){var r=Array.isArray(t),o=function(t,n){if(t){for(var r=Array(n.length),o=0;o<n.length;o++)Object.defineProperty(r,""+o,e(o,!0));return r}var i=Uo(n);delete i[Do];for(var a=Fo(i),u=0;u<a.length;u++){var c=a[u];i[c]=e(c,t||!!i[c].enumerable)}return Object.create(Object.getPrototypeOf(n),i)}(r,t),i={i:r?5:4,A:n?n.A:fo(),P:!1,I:!1,D:{},l:n,t:t,k:o,o:null,g:!1,C:!1};return Object.defineProperty(o,Do,{value:i,writable:!0}),o},S:function(e,n,o){o?Xr(n)&&n[Do].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var n=t[Do];if(n){var o=n.t,i=n.k,a=n.D,u=n.i;if(4===u)$r(i,function(t){t!==Do&&(void 0!==o[t]||Zr(o,t)?a[t]||e(i[t]):(a[t]=!0,Eo(n)))}),$r(o,function(e){void 0!==i[e]||Zr(i,e)||(a[e]=!1,Eo(n))});else if(5===u){if(r(n)&&(Eo(n),a.length=!0),i.length<o.length)for(var c=i.length;c<o.length;c++)a[c]=!1;else for(var s=o.length;s<i.length;s++)a[s]=!0;for(var f=Math.min(i.length,o.length),l=0;l<f;l++)void 0===a[l]&&e(i[l])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?n(e):r(e)}})}(),Yo("swSdk/init");var Zo=Yo("swSdk/destroy"),ei=Yo("swSdk/executeRequest"),ti=Yo("auth/error");Yo("auth/success"),Yo("socket/closed"),Yo("socket/error"),Yo("socket/message");var ni=function(e){return"@@redux-saga/"+e},ri=ni("CANCEL_PROMISE"),oi=ni("CHANNEL_END"),ii=ni("IO"),ai=ni("SELF_CANCELLATION"),ui=ni("TASK"),ci=ni("TASK_CANCEL"),si=ni("TERMINATE"),fi=ni("LOCATION");function li(){return(li=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var di=function(e){return"function"==typeof e},pi=Array.isArray,hi=function(e){return e&&di(e.then)},vi=function(e){return e&&di(e.next)&&di(e.throw)},yi=function(e){return function(){return!0}}(),mi=function(){},gi=function(e,t){li(e,t),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach(function(n){e[n]=t[n]})};function bi(e,t){var n=e.indexOf(t);n>=0&&e.splice(n,1)}var wi=function(e){throw e},Si=function(e){return{value:e,done:!0}};function ki(e,t,n){void 0===t&&(t=wi),void 0===n&&(n="iterator");var r={meta:{name:n},next:e,throw:t,return:Si,isSagaIterator:!0};return"undefined"!=typeof Symbol&&(r[Symbol.iterator]=function(){return r}),r}var Ei=function(e){return Array.apply(null,new Array(e))},Oi=function(e){return e===si},Pi=function(e){return e===ci},_i=function(e){return Oi(e)||Pi(e)};function xi(e,t){var n,r=Object.keys(e),o=r.length,i=0,a=pi(e)?Ei(o):{},u={};return r.forEach(function(e){var r=function(r,u){n||(u||_i(r)?(t.cancel(),t(r,u)):(a[e]=r,++i===o&&(n=!0,t(a))))};r.cancel=mi,u[e]=r}),t.cancel=function(){n||(n=!0,r.forEach(function(e){return u[e].cancel()}))},u}function Ii(e){return{name:e.name||"anonymous",location:Ai(e)}}function Ai(e){return e[fi]}var Ci=[],Ti=0;function ji(e){try{Ri(),e()}finally{Ni()}}function Ri(){Ti++}function Ni(){Ti--}function Li(){var e;for(Ni();!Ti&&void 0!==(e=Ci.shift());)ji(e)}var Di=function(e){return function(t){return e.some(function(e){return qi(e)(t)})}},Mi=function(e){return function(t){return e(t)}},Fi=function(e){return function(t){return t.type===String(e)}},Ui=function(e){return function(t){return t.type===e}},Vi=function(){return yi};function qi(e){var t,n="*"===e?Vi:function(e){return"string"==typeof e}(e)?Fi:pi(e)?Di:function(e){return di(e)&&e.hasOwnProperty("toString")}(e)?Fi:di(e)?Mi:(t=e,Boolean(t)&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?Ui:null);if(null===n)throw new Error("invalid pattern: "+e);return n(e)}var Bi={type:oi},Ki=function(e){return e&&e.type===oi};function Hi(e,t){var n=e[ri];di(n)&&(t.cancel=n),e.then(t,function(e){t(e,!0)})}var Wi,zi=0;function Gi(e){e.isRunning()&&e.cancel()}var Ji=((Wi={}).TAKE=function(e,t,n){var r=t.channel,o=void 0===r?e.channel:r,i=t.pattern,a=t.maybe,u=function(e){e instanceof Error?n(e,!0):!Ki(e)||a?n(e):n(si)};try{o.take(u,function(e){return null!=e}(i)?qi(i):null)}catch(e){return void n(e,!0)}n.cancel=u.cancel},Wi.PUT=function(e,t,n){var r=t.channel,o=t.action,i=t.resolve;Ci.push(function(){var t;try{t=(r?r.put:e.dispatch)(o)}catch(e){return void n(e,!0)}i&&hi(t)?Hi(t,n):n(t)}),Ti||(Ri(),Li())},Wi.ALL=function(e,t,n,r){var o=r.digestEffect,i=zi,a=Object.keys(t);if(0!==a.length){var u=xi(t,n);a.forEach(function(e){o(t[e],i,u[e],e)})}else n(pi(t)?[]:{})},Wi.RACE=function(e,t,n,r){var o=r.digestEffect,i=zi,a=Object.keys(t),u=pi(t)?Ei(a.length):{},c={},s=!1;a.forEach(function(e){var t=function(t,r){s||(r||_i(t)?(n.cancel(),n(t,r)):(n.cancel(),s=!0,u[e]=t,n(u)))};t.cancel=mi,c[e]=t}),n.cancel=function(){s||(s=!0,a.forEach(function(e){return c[e].cancel()}))},a.forEach(function(e){s||o(t[e],i,c[e],e)})},Wi.CALL=function(e,t,n,r){var o=t.context,i=t.fn,a=t.args,u=r.task;try{var c=i.apply(o,a);if(hi(c))return void Hi(c,n);if(vi(c))return void ra(e,c,u.context,zi,Ii(i),!1,n);n(c)}catch(e){n(e,!0)}},Wi.CPS=function(e,t,n){var r=t.context,o=t.fn,i=t.args;try{var a=function(e,t){!function(e){return null==e}(e)?n(e,!0):n(t)};o.apply(r,i.concat(a)),a.cancel&&(n.cancel=a.cancel)}catch(e){n(e,!0)}},Wi.FORK=function(e,t,n,r){var o=t.fn,i=t.detached,a=r.task,u=function(e){var t=e.context,n=e.fn,r=e.args;try{var o=n.apply(t,r);if(vi(o))return o;var i=!1;return ki(function(e){return i?{value:e,done:!0}:(i=!0,{value:o,done:!hi(o)})})}catch(e){return ki(function(){throw e})}}({context:t.context,fn:o,args:t.args}),c=function(e,t){return e.isSagaIterator?{name:e.meta.name}:Ii(t)}(u,o);!function(t){try{Ri(),r=ra(e,u,a.context,zi,c,i,void 0),i?n(r):r.isRunning()?(a.queue.addTask(r),n(r)):r.isAborted()?a.queue.abort(r.error()):n(r)}finally{Li()}var r}()},Wi.JOIN=function(e,t,n,r){var o=r.task,i=function(e,t){if(e.isRunning()){var n={task:o,cb:t};t.cancel=function(){e.isRunning()&&bi(e.joiners,n)},e.joiners.push(n)}else e.isAborted()?t(e.error(),!0):t(e.result())};if(pi(t)){if(0===t.length)return void n([]);var a=xi(t,n);t.forEach(function(e,t){i(e,a[t])})}else i(t,n)},Wi.CANCEL=function(e,t,n,r){t===ai?Gi(r.task):pi(t)?t.forEach(Gi):Gi(t),n()},Wi.SELECT=function(e,t,n){var r=t.selector,o=t.args;try{n(r.apply(void 0,[e.getState()].concat(o)))}catch(e){n(e,!0)}},Wi.ACTION_CHANNEL=function(e,t,n){var r=t.pattern,o=function(e){void 0===e&&(e=function(e,t){void 0===e&&(e=10);var n=new Array(e),r=0,o=0,i=0,a=function(){if(0!=r){var t=n[i];return n[i]=null,r--,i=(i+1)%e,t}},u=function(){for(var e=[];r;)e.push(a());return e};return{isEmpty:function(){return 0==r},put:function(t){var a;r<e||(a=2*e,n=u(),r=n.length,o=n.length,i=0,n.length=a,e=a),function(t){n[o]=t,o=(o+1)%e,r++}(t)},take:a,flush:u}}(void 0));var t=!1,n=[];return{take:function(r){t&&e.isEmpty()?r(Bi):e.isEmpty()?(n.push(r),r.cancel=function(){bi(n,r)}):r(e.take())},put:function(r){if(!t){if(0===n.length)return e.put(r);n.shift()(r)}},flush:function(n){t&&e.isEmpty()?n(Bi):n(e.flush())},close:function(){if(!t){t=!0;var e=n;n=[];for(var r=0,o=e.length;r<o;r++)(0,e[r])(Bi)}}}}(t.buffer),i=qi(r),a=function t(n){Ki(n)||e.channel.take(t,i),o.put(n)},u=o.close;o.close=function(){a.cancel(),u()},e.channel.take(a,i),n(o)},Wi.CANCELLED=function(e,t,n,r){n(r.task.isCancelled())},Wi.FLUSH=function(e,t,n){t.flush(n)},Wi.GET_CONTEXT=function(e,t,n,r){n(r.task.context[t])},Wi.SET_CONTEXT=function(e,t,n,r){gi(r.task.context,t),n()},Wi);function Xi(e,t){return e+"?"+t}function Yi(e){var t=e.name,n=e.location;return n?t+"  "+Xi(n.fileName,n.lineNumber):t}function $i(e){var t,n=(t=[]).concat.apply(t,e.map(function(e){return e.cancelledTasks}));return n.length?["Tasks cancelled due to error:"].concat(n).join("\n"):""}var Qi=null,Zi=[],ea=function(e){e.crashedEffect=Qi,Zi.push(e)},ta=function(){Qi=null,Zi.length=0},na=function(){var e,t=Zi[0],n=Zi.slice(1),r=t.crashedEffect?(e=Ai(t.crashedEffect))?e.code+"  "+Xi(e.fileName,e.lineNumber):"":null;return["The above error occurred in task "+Yi(t.meta)+(r?" \n when executing effect "+r:"")].concat(n.map(function(e){return"    created by "+Yi(e.meta)}),[$i(Zi)]).join("\n")};function ra(e,t,n,r,o,i,a){var u=e.finalizeRunEffect(function(t,n,r){hi(t)?Hi(t,r):vi(t)?ra(e,t,s.context,n,o,!1,r):t&&t[ii]?(0,Ji[t.type])(e,t.payload,r,f):r(t)});l.cancel=mi;var c={meta:o,cancel:function(){0===c.status&&(c.status=1,l(ci))},status:0},s=function(e,t,n,r,o,i,a){var u;void 0===a&&(a=mi);var c,s,f=0,l=null,d=[],p=Object.create(n),h=function(e,t,n){var r,o=[],i=!1;function a(e){d.push.apply(d,h.getTasks().map(function(e){return e.meta.name})),c(),n(e,!0)}function u(t){o.push(t),t.cont=function(u,c){i||(bi(o,t),t.cont=mi,c?a(u):(t===e&&(r=u),o.length||(i=!0,n(r))))}}function c(){i||(i=!0,o.forEach(function(e){e.cont=mi,e.cancel()}),o=[])}return u(e),{addTask:u,cancelAll:c,abort:a,getTasks:function(){return o}}}(t,0,v);function v(t,n){if(n){if(f=2,ea({meta:o,cancelledTasks:d}),y.isRoot){var r=na();ta(),e.onError(t,{sagaStack:r})}s=t,l&&l.reject(t)}else t===ci?f=1:1!==f&&(f=3),c=t,l&&l.resolve(t);y.cont(t,n),y.joiners.forEach(function(e){e.cb(t,n)}),y.joiners=null}var y=((u={})[ui]=!0,u.id=r,u.meta=o,u.isRoot=i,u.context=p,u.joiners=[],u.queue=h,u.cancel=function(){0===f&&(f=1,h.cancelAll(),v(ci,!1))},u.cont=a,u.end=v,u.setContext=function(e){gi(p,e)},u.toPromise=function(){return l||((e={}).promise=new Promise(function(t,n){e.resolve=t,e.reject=n}),l=e,2===f?l.reject(s):0!==f&&l.resolve(c)),l.promise;var e},u.isRunning=function(){return 0===f},u.isCancelled=function(){return 1===f||0===f&&1===t.status},u.isAborted=function(){return 2===f},u.result=function(){return c},u.error=function(){return s},u);return y}(e,c,n,r,o,i,a),f={task:s,digestEffect:d};return a&&(a.cancel=s.cancel),l(),s;function l(e,n){try{var o;n?(o=t.throw(e),ta()):Pi(e)?(c.status=1,l.cancel(),o=di(t.return)?t.return(ci):{done:!0,value:ci}):o=Oi(e)?di(t.return)?t.return():{done:!0}:t.next(e),o.done?(1!==c.status&&(c.status=3),c.cont(o.value)):d(o.value,r,l)}catch(e){if(1===c.status)throw e;c.status=2,c.cont(e,!0)}}function d(t,n,r,o){void 0===o&&(o="");var i,a=++zi;function c(n,o){i||(i=!0,r.cancel=mi,e.sagaMonitor&&(o?e.sagaMonitor.effectRejected(a,n):e.sagaMonitor.effectResolved(a,n)),o&&function(e){Qi=e}(t),r(n,o))}e.sagaMonitor&&e.sagaMonitor.effectTriggered({effectId:a,parentEffectId:n,label:o,effect:t}),c.cancel=mi,r.cancel=function(){i||(i=!0,c.cancel(),c.cancel=mi,e.sagaMonitor&&e.sagaMonitor.effectCancelled(a))},u(t,a,c)}}var oa={byId:{}},ia=Qo({name:"components",initialState:oa,reducers:{upsert:function(e,t){var n=t.payload;n.id in e.byId?Object.keys(n).forEach(function(t){e.byId[n.id][t]=n[t]}):e.byId[n.id]=n},executeSuccess:function(e,t){var n=t.payload,r=n.componentId,o=n.requestId,i=n.response;e.byId[r]&&(e.byId[r].responses=e.byId[r].responses||{},e.byId[r].responses[o]=i)},executeFailure:function(e,t){var n=t.payload,r=n.componentId,o=n.requestId,i=n.error,a=n.action;e.byId[r]&&(e.byId[r].errors=e.byId[r].errors||{},e.byId[r].errors[o]={action:a,jsonrpc:i})}},extraReducers:function(e){e.addCase(Zo.type,function(){return oa})}}),aa={protocol:"",iceServers:[],authStatus:"unknown",authError:void 0};!function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var o=t[r];"function"==typeof e[o]&&(n[o]=e[o])}Object.keys(n);try{!function(e){Object.keys(e).forEach(function(t){var n=e[t];if(void 0===n(void 0,{type:zo.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===n(void 0,{type:zo.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+zo.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}(n)}catch(e){}}({components:ia.reducer,session:Qo({name:"session",initialState:aa,reducers:{connected:function(e,t){var n,r,o,i,a=t.payload;e.authStatus="authorized",e.protocol=null!=(n=null==a||null==(r=a.result)?void 0:r.protocol)?n:"",e.iceServers=null!=(o=null==a||null==(i=a.result)?void 0:i.iceServers)?o:[]}},extraReducers:function(e){e.addCase(Zo.type,function(){return aa}),e.addCase(ti.type,function(e,t){var n=t.payload;e.authStatus="unauthorized",e.authError=n.error})}}).reducer});var ua,ca,sa,fa=function(){function e(e){this.options=e,this.id=Dr(),this._requests=new Map}var t=e.prototype;return t.on=function(){var e;return(e=this.emitter).on.apply(e,[].slice.call(arguments))},t.once=function(){var e;return(e=this.emitter).once.apply(e,[].slice.call(arguments))},t.off=function(){var e;return(e=this.emitter).off.apply(e,[].slice.call(arguments))},t.emit=function(){var e;return(e=this.emitter).emit.apply(e,[].slice.call(arguments))},t.removeAllListeners=function(){var e;return(e=this.emitter).removeAllListeners.apply(e,[].slice.call(arguments))},t.destroy=function(){var e;null==(e=this._destroyer)||e.call(this),this.removeAllListeners()},t.execute=function(e){var t=this,n=e.method,r=e.params;return new Promise(function(e,o){var i=Dr();t._requests.set(i,{resolve:e,reject:o}),t.store.dispatch(ei({requestId:i,componentId:t.id,method:n,params:r}))})},t.select=function(e){return e(this.store.getState())},t.onError=function(e){var t=this;this._requests.forEach(function(n,r){n.reject(e.errors[r]),t._requests.delete(r)})},t.onSuccess=function(e){var t=this;this._requests.forEach(function(n,r){n.resolve(e.responses[r]),t._requests.delete(r)})},n(e,[{key:"destroyer",set:function(e){this._destroyer=e}},{key:"store",get:function(){return this.options.store}},{key:"emitter",get:function(){return this.options.emitter}}]),e}(),la=Ar({},{__proto__:null,getIceServers:function(e){var t,n=e.session;return null!=(t=null==n?void 0:n.iceServers)?t:[]}}),da=function(e){return e&&e instanceof MediaStream},pa=function(e){return"object"==typeof document&&"getElementById"in document?"string"==typeof e?document.getElementById(e)||null:"function"==typeof e?e():e instanceof HTMLMediaElement?e:null:null},ha=function(e){var t;da(e)&&(null==e||null==(t=e.getTracks())||t.forEach(va))},va=function(e){e&&"live"===e.readyState&&(e.stop(),e.dispatchEvent(new Event("ended")))};!function(e){e.Offer="offer",e.Answer="answer"}(ua||(ua={})),function(e){e.Inbound="inbound",e.Outbound="outbound"}(ca||(ca={})),function(e){e.Generic="event",e.ParticipantData="participantData",e.ConferenceUpdate="conferenceUpdate",e.CallUpdate="callUpdate",e.VertoClientReady="vertoClientReady",e.UserMediaError="userMediaError",e.RefreshToken="refreshToken",e.Prompt="prompt",e.Announce="announce",e.DeviceUpdated="deviceUpdated",e.MediaParams="mediaParams"}(sa||(sa={}));var ya,ma,ga,ba={destinationNumber:"",remoteCallerName:"Outbound Call",remoteCallerNumber:"",callerName:"",callerNumber:"",audio:!0,video:!0,useStereo:!1,attach:!1,screenShare:!1,secondSource:!1,userVariables:{},requestTimeout:1e4,experimental:!1,autoApplyMediaParams:!0,iceGatheringTimeout:2e3};!function(e){e.Participant="participant",e.Moderator="moderator"}(ya||(ya={})),function(e){e.Join="join",e.Leave="leave",e.Bootstrap="bootstrap",e.Add="add",e.Modify="modify",e.Delete="delete",e.Clear="clear",e.ChatMessage="chatMessage",e.LayerInfo="layerInfo",e.LogoInfo="logoInfo",e.LayoutInfo="layoutInfo",e.LayoutList="layoutList",e.ModCmdResponse="modCommandResponse",e.ConferenceInfo="conferenceInfo",e.CaptionInfo="captionInfo"}(ma||(ma={})),function(e){e.Video="videoinput",e.AudioIn="audioinput",e.AudioOut="audiooutput"}(ga||(ga={}));var wa=function(e,t,n){try{return Promise.resolve(function(e,t){void 0===t&&(t=!1);try{return Promise.resolve(function(e){try{return Promise.resolve(navigator.mediaDevices.enumerateDevices().catch(function(e){return[]})).then(function(t){return e&&(t=t.filter(function(t){return t.kind===e})),t})}catch(e){return Promise.reject(e)}}(e)).then(function(e){if(!0===t)return e;var n=[];return e.filter(function(e){var t=e.groupId;if(!e.deviceId||!e.label)return!1;if(!t)return!0;var r=e.kind+"-"+t;return!n.includes(r)&&(n.push(r),!0)})})}catch(e){return Promise.reject(e)}}(n,!0)).then(function(n){for(var r=0;r<n.length;r++){var o=n[r],i=o.deviceId;if(e===i||t===o.label)return i}return null})}catch(e){return Promise.reject(e)}},Sa=function(e){try{return Vr.info("RTCService.getUserMedia",e),Promise.resolve(e.audio||e.video?xr(function(){return Promise.resolve(function(e){return navigator.mediaDevices.getUserMedia(e)}(e))},function(e){throw Vr.error("getUserMedia error: ",e),e}):null)}catch(e){return Promise.reject(e)}},ka=function(e){try{var t=function(){function t(){return{audio:r,video:o}}var n=e.video,o=void 0!==n&&n,i=e.camId,a=e.camLabel,u=void 0===a?"":a,c=function(){if(i)return Promise.resolve(wa(i,u,ga.Video).catch(function(e){return null})).then(function(e){e&&("boolean"==typeof o&&(o={}),o.deviceId={exact:e})})}();return c&&c.then?c.then(t):t()},n=e.audio,r=void 0===n||n,o=e.micId,i=e.micLabel,a=void 0===i?"":i,u=function(){if(o)return Promise.resolve(wa(o,a,ga.AudioIn).catch(function(e){return null})).then(function(e){e&&("boolean"==typeof r&&(r={}),r.deviceId={exact:e})})}();return Promise.resolve(u&&u.then?u.then(t):t())}catch(e){return Promise.reject(e)}},Ea=function(e,t,n){if(!da(e))return null;var r=function(e){switch(n){case!0:e.enabled=!0;break;case!1:e.enabled=!1;break;default:e.enabled=!e.enabled}};switch(t){case"audio":return e.getAudioTracks().forEach(r);case"video":return e.getVideoTracks().forEach(r);default:return e.getTracks().forEach(r)}},Oa=function(e){return Ea(e,"audio",!0)},Pa=function(e){return Ea(e,"audio",!1)},_a=function(e){return Ea(e,"audio")},xa=function(e){return/^m=audio/.test(e)},Ia=function(e){return/^m=video/.test(e)},Aa=function(e){var t=e.split("\r\n"),n=t.findIndex(function(e){return/^a=rtpmap/.test(e)&&/opus\/48000/.test(e)});if(n<0)return e;var r=function(e){var t=new RegExp("a=rtpmap:(\\d+) \\w+\\/\\d+"),n=e.match(t);return n&&2==n.length?n[1]:null}(t[n]),o=new RegExp("a=fmtp:"+r),i=t.findIndex(function(e){return o.test(e)});return i>=0?/stereo=1;/.test(t[i])||(t[i]+="; stereo=1; sprop-stereo=1"):t[n]+="\r\na=fmtp:"+r+" stereo=1; sprop-stereo=1",t.join("\r\n")},Ca=function(){function e(e,t){this.call=e,this.type=t,this._negotiating=!1,this.options=e.options,Vr.info("New Peer with type:",this.type,"Options:",this.options),this._onIce=this._onIce.bind(this),this._init()}var t=e.prototype;return t.stopTrackSender=function(e){try{var t,n,r=this._getSenderByKind(e);if(!r)return Vr.info("There is not a '"+e+"' sender to stop.");r.track&&(va(r.track),null==(t=this.options)||null==(n=t.localStream)||n.removeTrack(r.track))}catch(t){Vr.error("RTCPeer stopTrackSender error",e,t)}},t.restoreTrackSender=function(e){try{var t=this;return Promise.resolve(xr(function(){var n=t._getSenderByKind(e);return n?n.track&&"ended"!==n.track.readyState?Vr.info("There is already an active "+e+" track."):Promise.resolve(ka(t.options)).then(function(r){var o;return Promise.resolve(Sa((o={},o[e]=r[e],o))).then(function(r){var o=function(){if(r&&da(r)){var o=r.getTracks().find(function(t){return t.kind===e}),i=function(){var e,r;if(o)return Promise.resolve(n.replaceTrack(o)).then(function(){null==(e=t.options)||null==(r=e.localStream)||r.addTrack(o)})}();if(i&&i.then)return i.then(function(){})}}();if(o&&o.then)return o.then(function(){})})}):Vr.info("There is not a '"+e+"' sender to restore.")},function(t){Vr.error("RTCPeer restoreTrackSender error",e,t)}))}catch(e){return Promise.reject(e)}},t.getDeviceId=function(e){try{var t=this._getSenderByKind(e);if(!t||!t.track)return null;var n=t.track.getSettings().deviceId;return void 0===n?null:n}catch(t){return Vr.error("RTCPeer getDeviceId error",e,t),null}},t.getTrackSettings=function(e){try{var t=this._getSenderByKind(e);return t&&t.track?t.track.getSettings():null}catch(t){return Vr.error("RTCPeer getTrackSettings error",e,t),null}},t.getDeviceLabel=function(e){try{var t=this._getSenderByKind(e);return t&&t.track?t.track.label:null}catch(t){return Vr.error("RTCPeer getDeviceLabel error",e,t),null}},t.restartIceWithRelayOnly=function(){try{var e=this.instance.getConfiguration();if("relay"===e.iceTransportPolicy)return console.warn("RTCPeer already with iceTransportPolicy relay only");var t=Ir({},e,{iceTransportPolicy:"relay"});this.instance.setConfiguration(t),this.instance.restartIce()}catch(e){Vr.error("RTCPeer restartIce error",e)}},t.applyMediaConstraints=function(e,t){try{var n=this;return Promise.resolve(xr(function(){var r=n._getSenderByKind(e);if(!r||!r.track)return Vr.info("No sender to apply constraints",e,t);var o=function(){if("live"===r.track.readyState)return Vr.info("Apply "+e+" constraints",n.options.id,t),Promise.resolve(r.track.applyConstraints(t)).then(function(){})}();return o&&o.then?o.then(function(){}):void 0},function(){Vr.error("Error applying constraints",e,t)}))}catch(e){return Promise.reject(e)}},t._getSenderByKind=function(e){return this.instance.getSenders().find(function(t){var n=t.track;return n&&n.kind===e})},t._getReceiverByKind=function(e){return this.instance.getReceivers().find(function(t){var n=t.track;return n&&n.kind===e})},t.startNegotiation=function(e){void 0===e&&(e=!1);try{var t=this;if(t._negotiating)return Promise.resolve(Vr.warn("Skip twice onnegotiationneeded!"));t._negotiating=!0;var n=xr(function(){function n(){function n(){e&&t._sdpReady()}var r=function(){if(t.isAnswer)return Vr.info("Trying to generate answer"),Promise.resolve(t._setRemoteDescription({sdp:t.options.remoteSdp,type:ua.Offer})).then(function(){return Promise.resolve(t.instance.createAnswer({voiceActivityDetection:!1})).then(function(e){return Promise.resolve(t._setLocalDescription(e)).then(function(){})})})}();return r&&r.then?r.then(n):n()}!0===t.options.secondSource&&t.instance.getTransceivers().forEach(function(e){e.direction="sendonly"}),t.instance.removeEventListener("icecandidate",t._onIce),t.instance.addEventListener("icecandidate",t._onIce);var r=function(){if(t.isOffer)return Vr.info("Trying to generate offer"),Promise.resolve(t.instance.createOffer({voiceActivityDetection:!1})).then(function(e){return Promise.resolve(t._setLocalDescription(e)).then(function(){})})}();return r&&r.then?r.then(n):n()},function(e){Vr.error("Error creating "+t.type+":",e)});return Promise.resolve(n&&n.then?n.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},t.onRemoteSdp=function(e){try{var t=this,n=xr(function(){return Promise.resolve(t._setRemoteDescription({sdp:e,type:t.isOffer?ua.Answer:ua.Offer})).then(function(){})},function(e){Vr.error("Error handling remote SDP on call "+t.options.id+":",e),t.call.hangup()});return Promise.resolve(n&&n.then?n.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},t._init=function(){try{var e=this;return e.instance=new window.RTCPeerConnection(e.config),e.instance.onsignalingstatechange=function(){switch(Vr.info("signalingState:",e.instance.signalingState),e.instance.signalingState){case"stable":e._negotiating=!1;break;case"closed":delete e.instance;break;default:e._negotiating=!0}},e.instance.onnegotiationneeded=function(){Vr.info("Negotiation needed event"),e.startNegotiation()},e.instance.addEventListener("track",function(t){e.call.emit("track",t),e.options.remoteStream=t.streams[0]}),e.instance.addEventListener("addstream",function(t){t.stream&&(e.options.remoteStream=t.stream)}),Promise.resolve(e._retrieveLocalStream().catch(function(e){return Vr.error("Error getting localStream",e),null})).then(function(t){e.options.localStream=t;var n,r=e.options,o=r.localElement,i=r.localStream,a=void 0===i?null:i,u=r.screenShare;if(a&&da(a)){var c=a.getAudioTracks();Vr.info("Local audio tracks: ",c);var s=a.getVideoTracks();if(Vr.info("Local video tracks: ",s),e.isOffer&&"function"==typeof e.instance.addTransceiver){c.forEach(function(t){e.instance.addTransceiver(t,{direction:"sendrecv",streams:[a]})});var f={direction:"sendrecv",streams:[a]};if(e.isSimulcast&&(f.sendEncodings=["0","1","2"].map(function(e){return{active:!0,rid:e,scaleResolutionDownBy:6*Number(e)||1}})),console.debug("Applying video transceiverParams",f),s.forEach(function(t){e.instance.addTransceiver(t,f)}),e.isSfu){var l=e.options.msStreamsNumber,d=void 0===l?5:l;console.debug("Add ",d,"recvonly MS Streams"),f.direction="recvonly";for(var p=0;p<Number(d);p++)e.instance.addTransceiver("video",f)}}else"function"==typeof e.instance.addTrack?(c.forEach(function(t){e.instance.addTrack(t,a)}),s.forEach(function(t){e.instance.addTrack(t,a)})):e.instance.addStream(a);!1===u&&((n=pa(o))&&(n.muted=!0),function(e,t){var n=pa(e);null!==n&&(n.getAttribute("autoplay")||n.setAttribute("autoplay","autoplay"),n.getAttribute("playsinline")||n.setAttribute("playsinline","playsinline"),n.srcObject=t)}(o,a))}e.isOffer?(e.options.negotiateAudio&&e._checkMediaToNegotiate("audio"),e.options.negotiateVideo&&e._checkMediaToNegotiate("video")):e.startNegotiation()})}catch(e){return Promise.reject(e)}},t._checkMediaToNegotiate=function(e){if(!this._getSenderByKind(e)){var t=this.instance.addTransceiver(e);console.debug("Add transceiver",e,t)}},t._sdpReady=function(){if(clearTimeout(this._iceTimeout),this._iceTimeout=null,this.instance.localDescription){var e=this.instance.localDescription,t=e.sdp,n=e.type;if(-1===t.indexOf("candidate"))return Vr.info("No candidate - retry \n"),void this.startNegotiation(!0);Vr.info("LOCAL SDP \n","Type: "+n,"\n\n",t),this.instance.removeEventListener("icecandidate",this._onIce),this.call.onLocalSDPReady(this.instance.localDescription)}},t._onIce=function(e){var t=this;null===this._iceTimeout&&(this._iceTimeout=setTimeout(function(){return t._sdpReady()},this.options.iceGatheringTimeout)),e.candidate?(Vr.debug("RTCPeer Candidate:",e.candidate),this.call.emit("icecandidate",e)):this._sdpReady()},t._setLocalDescription=function(e){var t,n,r,o,i=this.options,a=i.googleMaxBitrate,u=i.googleMinBitrate,c=i.googleStartBitrate;return e.sdp&&i.useStereo&&(e.sdp=Aa(e.sdp)),e.sdp&&a&&u&&c&&(e.sdp=(t=a,n=u,r=c,(o=e.sdp.split("\r\n")).forEach(function(e,i){/^a=fmtp:\d*/.test(e)?o[i]+=";x-google-max-bitrate="+t+";x-google-min-bitrate="+n+";x-google-start-bitrate="+r:/^a=mid:(1|video)/.test(e)&&(o[i]+="\r\nb=AS:"+t)}),o.join("\r\n"))),Vr.info("LOCAL SDP \n","Type: "+e.type,"\n\n",e.sdp),this.instance.setLocalDescription(e)},t._setRemoteDescription=function(e){e.sdp&&this.options.useStereo&&(e.sdp=Aa(e.sdp)),e.sdp&&this.instance.localDescription&&(e.sdp=function(e,t){var n="\r\n",r=t.split(n);if(r.findIndex(xa)<r.findIndex(Ia))return e;var o=e.split(n),i=o.findIndex(xa),a=o.findIndex(Ia),u=o.slice(i,a),c=o.slice(a,o.length-1),s=o.slice(0,i);return[].concat(s,c,u,[""]).join(n)}(e.sdp,this.instance.localDescription.sdp));var t=e;return Vr.info("REMOTE SDP \n","Type: "+e.type,"\n\n",e.sdp),this.instance.setRemoteDescription(t)},t._retrieveLocalStream=function(){try{var e=this;return da(e.options.localStream)?Promise.resolve(e.options.localStream):Promise.resolve(ka(e.options)).then(Sa)}catch(e){return Promise.reject(e)}},n(e,[{key:"isOffer",get:function(){return this.type===ua.Offer}},{key:"isAnswer",get:function(){return this.type===ua.Answer}},{key:"isSimulcast",get:function(){return!0===this.options.simulcast}},{key:"isSfu",get:function(){return!0===this.options.sfu}},{key:"hasExperimentalFlag",get:function(){return!0===this.options.experimental}},{key:"localVideoTrack",get:function(){var e=this._getSenderByKind("video");return(null==e?void 0:e.track)||null}},{key:"localAudioTrack",get:function(){var e=this._getSenderByKind("audio");return(null==e?void 0:e.track)||null}},{key:"hasAudioSender",get:function(){return!!this._getSenderByKind("audio")}},{key:"hasVideoSender",get:function(){return!!this._getSenderByKind("video")}},{key:"hasAudioReceiver",get:function(){return!!this._getReceiverByKind("audio")}},{key:"hasVideoReceiver",get:function(){return!!this._getReceiverByKind("video")}},{key:"config",get:function(){var e=this.options,t=e.iceServers,n=e.rtcPeerConfig,r=Ir({bundlePolicy:"max-compat",iceServers:void 0===t?[]:t,sdpSemantics:"unified-plan"},void 0===n?{}:n);return Vr.info("RTC config",r),r}},{key:"localSdp",get:function(){var e,t;return null==(e=this.instance)||null==(t=e.localDescription)?void 0:t.sdp}}]),e}(),Ta=["room.started","room.subscribed","room.updated","room.ended","member.joined","member.updated","member.left","layout.changed"],ja=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t.prototype.desktopOnlyMethod=function(){console.debug("Desktop Method")},t}(function(e){function t(t){var n,r;(n=e.call(this,t)||this).nodeId="",n.gotEarly=!1,n.doReinvite=!1,n.isDirect=!1,n.videoElements=[],n.audioElements=[],n.participantLayerIndex=-1,n.participantLogo="",n.state=wr.New,n.prevState=wr.New,n.join=n.invite;var o=null!=(r=null==t?void 0:t.iceServers)?r:n.select(la.getIceServers);return n.options=Ir({id:n.id},ba,t,{iceServers:o}),n.options.remoteCallerNumber||(n.options.remoteCallerNumber=n.options.destinationNumber),n.setState(wr.New),Vr.info("New Call with Options:",n.options),n}o(t,e);var r=t.prototype;return r.vertoExecute=function(e){var t={message:e,node_id:this.nodeId};return e.method===br.Invite&&(t.subscribe=Ta),this.execute({method:"video.message",params:t})},r.onStateChange=function(e){switch(Vr.debug("onStateChange",e),e.state){case wr.Hangup:this._hangup(e);break;default:this.setState(e.state)}},r.onRemoteSDP=function(e){Vr.debug("onRemoteSDP",e),e.remoteSDP&&this.peer.onRemoteSdp(e.remoteSDP)},r.onRoomId=function(e){Vr.debug("onRoomId",e),this._roomId=e.roomId,this._roomSessionId=e.roomSessionId,this._memberId=e.memberId},r.invite=function(){this.direction=ca.Outbound,this.peer=new Ca(this,ua.Offer)},r.answer=function(){this.direction=ca.Inbound,this.peer=new Ca(this,ua.Answer)},r.onLocalSDPReady=function(e){var t=e.type,n=e.sdp;switch(Vr.info("SDP READY",t,n),t){case ua.Offer:this.executeInvite(n);break;case ua.Answer:Vr.warn("Unhandled verto.answer");break;default:return Vr.error("Unknown SDP type: '"+t+"' on call "+this.options.id)}},r.executeInvite=function(e){try{var t=this;t.setState(wr.Requesting);var n=xr(function(){var n=Wr(Ir({},t.messagePayload,{sdp:e}));return Promise.resolve(t.vertoExecute(n)).then(function(e){Vr.debug("Invite response",e)})},function(e){var n=e.jsonrpc;Vr.error("Invite Error",n,e.action),"404"===(null==n?void 0:n.code)&&t.setState(wr.Hangup)});return Promise.resolve(n&&n.then?n.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},r.hangup=function(){try{var e=this,t=function(t,n){try{var r=xr(function(){var t=zr(e.messagePayload);return Promise.resolve(e.vertoExecute(t)).then(function(){})},function(e){Vr.error("Hangup error:",e)})}catch(e){return n(!0,e)}return r&&r.then?r.then(n.bind(null,!1),n.bind(null,!0)):n(!1,r)}(0,function(t,n){if(e._hangup(),t)throw n;return n});return Promise.resolve(t&&t.then?t.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},r.dtmf=function(e){var t=Gr(Ir({},this.messagePayload,{dtmf:e}));this.vertoExecute(t)},r.disableOutboundAudio=function(){this.options.localStream&&Pa(this.options.localStream)},r.enableOutboundAudio=function(){this.options.localStream&&Oa(this.options.localStream)},r.toggleOutboundAudio=function(){this.options.localStream&&_a(this.options.localStream)},r.disableOutboundVideo=function(){this.options.localStream&&Ea(this.options.localStream,"video",!1)},r.enableOutboundVideo=function(){this.options.localStream&&Ea(this.options.localStream,"video",!0)},r.toggleOutboundVideo=function(){this.options.localStream&&Ea(this.options.localStream,"video")},r.disableInboundAudio=function(){this.options.remoteStream&&Pa(this.options.remoteStream)},r.enableInboundAudio=function(){this.options.remoteStream&&Oa(this.options.remoteStream)},r.toggleInboundAudio=function(){this.options.remoteStream&&_a(this.options.remoteStream)},r.doReinviteWithRelayOnly=function(){this.peer&&this.active&&this.peer.restartIceWithRelayOnly()},r.stopOutboundAudio=function(){this.peer&&this.active&&this.peer.stopTrackSender("audio")},r.restoreOutboundAudio=function(){this.peer&&this.active&&this.peer.restoreTrackSender("audio")},r.stopOutboundVideo=function(){this.peer&&this.active&&this.peer.stopTrackSender("video")},r.restoreOutboundVideo=function(){this.peer&&this.active&&this.peer.restoreTrackSender("video")},r.setState=function(e){switch(this.prevState=this.state,this.state=e,Vr.debug("Call "+this.id+" state change from "+this.prevState+" to "+this.state),this.emit(this.state,this),e){case wr.Purge:this.screenShare instanceof t&&this.screenShare.setState(wr.Purge),this.secondSource instanceof t&&this.secondSource.setState(wr.Purge),this._finalize();break;case wr.Hangup:this.screenShare instanceof t&&this.screenShare.hangup(),this.secondSource instanceof t&&this.secondSource.hangup(),this.setState(wr.Destroy);break;case wr.Destroy:this._finalize()}},r.audioMute=function(e){return this.execute({method:Sr.MemberAudioMute,params:{room_session_id:this._roomSessionId,member_id:e||this._memberId}})},r.audioUnmute=function(e){return this.execute({method:Sr.MemberAudioUnmute,params:{room_session_id:this._roomSessionId,member_id:e||this._memberId}})},r.videoMute=function(e){return this.execute({method:Sr.MemberVideoMute,params:{room_session_id:this._roomSessionId,member_id:e||this._memberId}})},r.videoUnmute=function(e){return this.execute({method:Sr.MemberVideoUnmute,params:{room_session_id:this._roomSessionId,member_id:e||this._memberId}})},r._hangup=function(e){void 0===e&&(e={});var t=e.byeCause,n=e.byeCauseCode,r=void 0===n?"16":n,o=e.redirectDestination;return this.cause=void 0===t?"NORMAL_CLEARING":t,this.causeCode=r,o&&this.trying&&this.peer.localSdp?(Vr.warn("Execute invite again"),this.executeInvite(this.peer.localSdp)):this.setState(wr.Hangup)},r._finalize=function(){this.peer&&this.peer.instance&&(this.peer.instance.close(),delete this.peer);var e=this.options,t=e.localStream;ha(e.remoteStream),ha(t),this.destroy()},n(t,[{key:"active",get:function(){return this.state===wr.Active}},{key:"trying",get:function(){return this.state===wr.Trying}},{key:"extension",get:function(){return this._extension||this.options.destinationNumber},set:function(e){this._extension=e}},{key:"memberId",get:function(){return this._memberId}},{key:"localStream",get:function(){return this.options.localStream}},{key:"remoteStream",get:function(){return this.options.remoteStream}},{key:"messagePayload",get:function(){var e=this.options;return{sessid:this.options.sessionid,dialogParams:{id:e.id,destinationNumber:e.destinationNumber,attach:e.attach,callerName:e.callerName,callerNumber:e.callerNumber,remoteCallerName:e.remoteCallerName,remoteCallerNumber:e.remoteCallerNumber,userVariables:e.userVariables,screenShare:e.screenShare}}}},{key:"cameraId",get:function(){return this.peer?this.peer.getDeviceId("video"):null}},{key:"cameraLabel",get:function(){return this.peer?this.peer.getDeviceLabel("video"):null}},{key:"microphoneId",get:function(){return this.peer?this.peer.getDeviceId("audio"):null}},{key:"microphoneLabel",get:function(){return this.peer?this.peer.getDeviceLabel("audio"):null}},{key:"withAudio",get:function(){return!!this.remoteStream&&this.remoteStream.getAudioTracks().length>0}},{key:"withVideo",get:function(){return!!this.remoteStream&&this.remoteStream.getVideoTracks().length>0}},{key:"htmlVideoElement",get:function(){return this.videoElements.length?this.videoElements[0]:null}},{key:"htmlAudioElement",get:function(){return this.audioElements.length?this.audioElements[0]:null}},{key:"localVideoTrack",get:function(){return this.peer.localVideoTrack}},{key:"localAudioTrack",get:function(){return this.peer.localAudioTrack}}]),t}(fa)),Ra=function(e){var t=document.createElement("video");t.muted=!0,t.autoplay=!0,t.playsInline=!0;var n=new MediaStream([e]);t.srcObject=n;var r=function(){return D.debug("Video can play")},o=function(){return D.debug("Video is playing")};return e.addEventListener("ended",function(){t.removeEventListener("play",o),t.removeEventListener("canplay",r),t.srcObject=null,t.remove()}),t},Na=function(e){var t,n=e.applyLocalVideoOverlay,r=void 0===n||n,o=document.getElementById(e.rootElementId)||document.body,i=new Map,a=function(e){var n=e.x,r=e.width,o=e.height;return{top:(100*e.y/t.videoHeight).toFixed(2)+"%",left:(100*n/t.videoWidth).toFixed(2)+"%",width:(100*r/t.videoWidth).toFixed(2)+"%",height:(100*o/t.videoHeight).toFixed(2)+"%"}};return{rtcTrackHandler:function(e){switch(e.track.kind){case"audio":!function(e){var t=new Audio;t.autoplay=!0,t.playsinline=!0;var n=new MediaStream([e]);t.srcObject=n;var r=function(){return D.debug("Audio can play!")},o=function(){return D.debug("Audio is playing")};t.addEventListener("play",o),t.addEventListener("canplay",r),e.addEventListener("ended",function(){t.removeEventListener("play",o),t.removeEventListener("canplay",r),t.srcObject=null,t.remove()})}(e.track);break;case"video":if((t=Ra(e.track)).style.width="100%",t.style.height="100%",!r)return void o.appendChild(t);var n=document.createElement("div");n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.right="0",n.style.bottom="0",n.appendChild(t);var i=document.createElement("div");i.style.paddingBottom="56.25%",i.appendChild(n);var a=document.createElement("div");a.classList.add("mcuLayers"),i.appendChild(a);var u=document.createElement("div");u.style.position="relative",u.style.width="100%",u.style.height="100%",u.style.margin="0 auto",u.appendChild(i),o.appendChild(u)}},destroyHandler:function(){for(;o.firstChild;)o.removeChild(o.firstChild)},layoutChangedHandler:function(e){var n=e.layout,u=void 0===n?{}:n,c=e.myMemberId,s=e.localVideoTrack;try{var f;return r&&s?Promise.resolve(function(e,n){try{var r=function(){function e(e){if(f)return e;var t=a(r),n=t.left,o=t.width,i=t.height;l.style.top=t.top,l.style.left=n,l.style.width=o,l.style.height=i,l.style.display="block"}var n=u.layers,r=(void 0===n?[]:n).find(function(e){return e.memberID===c});if(!r)return D.debug("Current Layer Not Found",JSON.stringify(u));var l=i.get(c),d=function(){if(!l)return Promise.resolve(function(e){try{var n=function(){var n=a(e),r=n.top,o=n.left,i=n.width,u=n.height;D.info("Info",t.offsetWidth,t.offsetHeight,t.videoWidth,t.videoHeight,r,o,i,u);var c=document.createElement("div");return c.style.position="absolute",c.style.overflow="hidden",c.style.top=r,c.style.left=o,c.style.width=i,c.style.height=u,c},r=function(){if(t.readyState===HTMLMediaElement.HAVE_NOTHING)return Promise.resolve(new Promise(function(e){t.addEventListener("canplay",function n(){t.removeEventListener("canplay",n),e()}),t.addEventListener("resize",function n(){t.removeEventListener("resize",n),e()})})).then(function(){})}();return Promise.resolve(r&&r.then?r.then(n):n())}catch(e){return Promise.reject(e)}}(r)).then(function(e){e.id=c;var t=Ra(s);t.style.width="100%",t.style.height="100%",e.appendChild(t),i.set(c,e);var n=o.querySelector(".mcuLayers"),r=document.getElementById(c);n&&!r&&n.appendChild(e),f=1})}();return d&&d.then?d.then(e):e(d)}()}catch(e){return n(e)}return r&&r.then?r.then(void 0,n):r}(0,function(e){D.error("Layout Changed Error",e)})):(D.info("Do not apply local video overlay"),Promise.resolve())}catch(e){return Promise.reject(e)}}}},La=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),n(t,[{key:"rooms",get:function(){var e=this;return{makeCall:function(t){var n=function(e){var t=e.onStateChangeListeners,n=void 0===t?{}:t,r=e.store,o=e.Component,i=Object.keys(n);return function(e){var t=new o(P({},e,{store:r})),a=new Map,u=r.subscribe(function(){var e,o=null==(e=r.getState().components.byId)?void 0:e[t.id];o&&i.forEach(function(e){var r=a.get(e),i=null==o?void 0:o[e];if(void 0!==i&&r!==i){a.set(e,i);var u=n[e];"string"==typeof u?t[u](o):u(o)}})});return r.dispatch(or.upsert({id:t.id})),t.destroyer=function(){u(),a.clear()},t}}({store:e.store,Component:ja,onStateChangeListeners:{state:"onStateChange",remoteSDP:"onRemoteSDP",roomId:"onRoomId",errors:"onError",responses:"onSuccess"}})(r({},t,{emitter:e.options.emitter})),o=t.rootElementId;if(o){var i=Na({rootElementId:o,applyLocalVideoOverlay:t.applyLocalVideoOverlay}),a=i.rtcTrackHandler,u=i.destroyHandler,c=i.layoutChangedHandler;n.on("layout.changed",function(e){c({layout:e.layout,localVideoTrack:n.localVideoTrack,myMemberId:n.memberId})}),n.on("layout.changed",function(e){c(e,n.memberId)}),n.on("track",a),n.on("destroy",u)}return n}}}}]),t}(Or),Da=function(e){try{var t=r({},e,{emitter:_r(e)}),n=function(e){var t,n=e.userOptions,r=e.SessionConstructor,o=e.preloadedState,i=void 0===o?{}:o,a=e.runSagaMiddleware,u=void 0===a||a,c=e.sagas,s=tr(),f=dt({devTools:null==(t=null==n?void 0:n.devTools)||t,reducer:sr,preloadedState:i,middleware:function(e){return e().concat(s)}});if(u){var l=function(e){return regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,gn(yt.type);case 2:return t.prev=2,t.next=5,Sn(hr,e.SessionConstructor,n);case 5:t.next=10;break;case 7:return t.prev=7,t.t0=t.catch(2),t.abrupt("return");case 10:case"end":return t.stop()}},t,null,[[2,7]])})}({sagas:c,SessionConstructor:r});s.run(l,n)}return f}({userOptions:t,SessionConstructor:Ot}),o=new La(t,n),i=function(){if(t.autoConnect)return Promise.resolve(o.connect()).then(function(){})}();return Promise.resolve(i&&i.then?i.then(function(){return o}):o)}catch(e){return Promise.reject(e)}};e.Client=La,e.JWTSession=Ot,e.createClient=Da,e.createRTCSession=function(e){return new Promise(function(t,n){try{var o=e.audio,i=void 0===o||o,a=e.video,u=void 0===a||a,c=e.iceServers,s=e.rootElementId,f=e.applyLocalVideoOverlay,l=void 0===f||f,d=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t.indexOf(n=i[r])>=0||(o[n]=e[n]);return o}(e,["audio","video","iceServers","rootElementId","applyLocalVideoOverlay"]);return Promise.resolve(Da(r({},d,{autoConnect:!0}))).then(function(e){var n=e.rooms.makeCall({destinationNumber:"room",callerName:"",callerNumber:"",audio:i,video:u,negotiateAudio:!0,negotiateVideo:!0,experimental:!0,iceServers:c});if(s){var r=Na({rootElementId:s,applyLocalVideoOverlay:l}),o=r.rtcTrackHandler,a=r.destroyHandler,f=r.layoutChangedHandler;n.on("layout.changed",function(e){f({layout:e.layout,localVideoTrack:n.localVideoTrack,myMemberId:n.memberId})}),n.on("track",o),n.on("destroy",a)}n.on("destroy",function(){e.disconnect()}),t(n)})}catch(e){return Promise.reject(e)}})}});
//# sourceMappingURL=index.umd.js.map
